if(jQuery)(function(){$.extend($.fn,{contextMenu:function(o,callback){if(o.menu==undefined)return false;if(o.inSpeed==undefined)o.inSpeed=150;if(o.outSpeed==undefined)o.outSpeed=75;if(o.leftButton==undefined)o.leftButton=false;if(o.inSpeed==0)o.inSpeed=-1;if(o.outSpeed==0)o.outSpeed=-1;$(this).each(function(){var el=$(this);var offset=$(el).offset();$('#'+o.menu).addClass('contextMenu');$(this).mousedown(function(e){var evt=e;$(this).mouseup(function(e){var srcElement=$(this);$(this).unbind('mouseup');if(evt.button==2||o.leftButton==true){$(".contextMenu").hide();var menu=$('#'+o.menu);if($(el).hasClass('disabled'))return false;var d={},x,y;if(self.innerHeight){d.pageYOffset=self.pageYOffset;d.pageXOffset=self.pageXOffset;d.innerHeight=self.innerHeight;d.innerWidth=self.innerWidth;}else if(document.documentElement&&document.documentElement.clientHeight){d.pageYOffset=document.documentElement.scrollTop;d.pageXOffset=document.documentElement.scrollLeft;d.innerHeight=document.documentElement.clientHeight;d.innerWidth=document.documentElement.clientWidth;}else if(document.body){d.pageYOffset=document.body.scrollTop;d.pageXOffset=document.body.scrollLeft;d.innerHeight=document.body.clientHeight;d.innerWidth=document.body.clientWidth;}
(e.pageX)?x=e.pageX:x=e.clientX+d.scrollLeft;(e.pageY)?y=e.pageY:x=e.clientY+d.scrollTop;$(document).unbind('click');$(menu).css({top:y,left:x}).fadeIn(o.inSpeed);$(menu).find('A').mouseover(function(){$(menu).find('LI.hover').removeClass('hover');$(this).parent().addClass('hover');}).mouseout(function(){$(menu).find('LI.hover').removeClass('hover');});$(document).keypress(function(e){switch(e.keyCode){case 38:if($(menu).find('LI.hover').size()==0){$(menu).find('LI:last').addClass('hover');}else{$(menu).find('LI.hover').removeClass('hover').prevAll('LI:not(.disabled)').eq(0).addClass('hover');if($(menu).find('LI.hover').size()==0)$(menu).find('LI:last').addClass('hover');}
break;case 40:if($(menu).find('LI.hover').size()==0){$(menu).find('LI:first').addClass('hover');}else{$(menu).find('LI.hover').removeClass('hover').nextAll('LI:not(.disabled)').eq(0).addClass('hover');if($(menu).find('LI.hover').size()==0)$(menu).find('LI:first').addClass('hover');}
break;case 13:$(menu).find('LI.hover A').trigger('click');break;case 27:$(document).trigger('click');break}});$('#'+o.menu).find('A').unbind('click');$('#'+o.menu).find('LI:not(.disabled) A').click(function(){$(document).unbind('click').unbind('keypress');$(".contextMenu").hide();if(callback)callback($(this).attr('href').substr(1),$(srcElement),{x:x-offset.left,y:y-offset.top,docX:x,docY:y});return false;});setTimeout(function(){$(document).click(function(){$(document).unbind('click').unbind('keypress');$(menu).fadeOut(o.outSpeed);return false;});},0);}});});if($.browser.mozilla){$('#'+o.menu).each(function(){$(this).css({'MozUserSelect':'none'});});}else if($.browser.msie){$('#'+o.menu).each(function(){$(this).bind('selectstart.disableTextSelect',function(){return false;});});}else{$('#'+o.menu).each(function(){$(this).bind('mousedown.disableTextSelect',function(){return false;});});}
$(el).add('UL.contextMenu').bind('contextmenu',function(){return false;});});return $(this);},disableContextMenuItems:function(o){if(o==undefined){$(this).find('LI').addClass('disabled');return($(this));}
$(this).each(function(){if(o!=undefined){var d=o.split(',');for(var i=0;i<d.length;i++){$(this).find('A[href="'+d[i]+'"]').parent().addClass('disabled');}}});return($(this));},enableContextMenuItems:function(o){if(o==undefined){$(this).find('LI.disabled').removeClass('disabled');return($(this));}
$(this).each(function(){if(o!=undefined){var d=o.split(',');for(var i=0;i<d.length;i++){$(this).find('A[href="'+d[i]+'"]').parent().removeClass('disabled');}}});return($(this));},disableContextMenu:function(){$(this).each(function(){$(this).addClass('disabled');});return($(this));},enableContextMenu:function(){$(this).each(function(){$(this).removeClass('disabled');});return($(this));},destroyContextMenu:function(){$(this).each(function(){$(this).unbind('mousedown').unbind('mouseup');});return($(this));}});})(jQuery);;var loadTripFlag=false;var tripLiId='';var activeTrip;var xhr=null;var deleteitem='';var removeitemid='';var mytriplist=null;var mytriplistupdate=null;var loadwidgetreq=null;var dashboardWidget=true;var weatherForMytrip='fn';var openPanelFromMyTrip=false;var tripPartWidget=false;var mytripdetailStatus='';var isEditAlreadyCalled=false;var getStatusCal;var DatesInlineArray=Array();function setTripPartContext(cityId,cityName,tripPartId,source){global_trip_part_id=tripPartId;if(typeof tripPartId=="undefined"){tripPartId=document.getElementById("tripPartId").value;}
activeTripPart={'cityId':cityId,'cityName':cityName,'tripPartId':tripPartId};document.getElementById("tripPartId").value=tripPartId;currentCityObject={'id':cityId,'n':cityName};if(cityName!=null&&typeof(cityName)!='undefined'){$('#showing_places_mytrips').html('Showing Places for <b>'+cityName+'</b>');}
if(typeof(map)!='undefined'){if(friendTripFlag==false){map.makeCitySelected(cityId,'M',source);}else{map.makeCitySelected(cityId,'');}}}
function openMyTabInfo(){if(docBottom==true||panelPositionY==true||dockPosition==true){restorPanel();}
myTripFlag=true;$("#goback").html('&laquo; Go back to My Trips');friendTripFlag=false;resetView();$("#OutrContainer").hide();$(".welcomeBox").hide();$("#geoInformation").hide();$("#PlanBookComponent").hide();$("#topNav li").removeClass("active");$("#friendstripslitab").removeClass("active");$("#mytripslitab").addClass("active");$("#topNavItems").hide();$("#friend_trip_wrapper").hide();$("#my_trip_wrapper").show();mytripInit();}
function getPanelByBucketId(id){if(id){var categorylist=new Array();categorylist[1]='Attraction';categorylist[3]='Restaurant';categorylist[4]='Nightlife';categorylist[6]='Shopping';categorylist[8]='Activity';categorylist[11]='Hotel';categorylist[12]='Event';categorylist[13]='Deal';categorylist[16]='Hostel';return categorylist[id];}else{return false;}}
function removeItemFromTrip(itemId,refreshItemList,mode,categoryId){if(getPanelByBucketId(categoryId)){$('#delete_item_dialog_text').html('Are you sure you want to remove this '+getPanelByBucketId(categoryId)+'?');}else{$('#delete_item_dialog_text').html('Are you sure you want to remove this item?');}
if(visibleMap=='bing'){$("#bing_attraction_info").hide();}
$("#delete_item_dialog").dialog({resizable:false,draggable:false,height:140,modal:true,dialogClass:'georama_dialog',buttons:{"Yes":function(){if(visibleMap=='bing'){removeMyTripPushPin();}
document.getElementById('item_detail_wrapper').innerHTML=preloadDiv;url='/mytrip/removeitem/i/'+itemId+'/mode/'+mode;$.get(url,function(result){if(refreshItemList==true){var isWidget=$("#widget_wrapper").is(':visible');if(isWidget==true){loadTripInfo(global_trip_id);}else{var isItemDetail=$("#item_detail_wrapper").is(':visible');if(isItemDetail==true){fillTripItems(document.getElementById('mytrip_item_type').value,global_trip_id);}}}
if(deleteitem==itemId){if(getPanelByBucketId(categoryId)){document.getElementById('item_detail_wrapper').innerHTML='<article class="info padding align-center font_16">'+getPanelByBucketId(categoryId)+' has been removed successfully! </article>';}else{document.getElementById('item_detail_wrapper').innerHTML='<article class="info padding align-center font_16">Item has been removed successfully! </article>';}}});$(this).dialog("close");},Cancel:function(){$(this).dialog("close");}},open:function(event,ui){resetDialogZIndex();$(document).bind('scroll',function(){window.scrollTo(0,0);$(".ui-widget.ui-dialog").css({'top':'280px'});});},close:function(event,ui){$(document).unbind('scroll');}});}
function friendTripInit(){var url='/html5/friendtrip/list/rand/'+parseInt(Math.random()*99999999);$.get(url,function(data){hideFriendLeftLoader();$("#friendtrip_left").html(data);});if(global_trip_id!=''){loadTripInfo(global_trip_id);}else{loadTripInfo();}}
function getTripList(){myTripFlag=true;$("#goback").html('&laquo; Go back to My Trips');friendTripFlag=false;resetView();$("#OutrContainer").hide();$(".welcomeBox").hide();$("#geoInformation").hide();$("#PlanBookComponent").hide();$("#topNav li").removeClass("active");$("#friendstripslitab").removeClass("active");$("#mytripslitab").addClass("active");$("#topNavItems").hide();$("#friend_trip_wrapper").hide();$("#my_trip_wrapper").show();$("#my_trips_panel_heading").html('My Trips');var url='/html5/mytrip/list';var params='rand='+parseInt(Math.random()*99999999);$.ajax({type:"GET",url:url,data:params,success:function(data){hideLeftLoader();$("#mytrip_left").html(data);$("#mytrip_left .scrollbar_wrapper").tinyscrollbar({sizethumb:25});}});$("#trip_list li").removeClass("active");var id=$("#tripPlaceId").val();$("#trip_"+id).addClass('active');var HashTripName=$("#tripPlaceName").text();if(global_trip_id!=''){tripNameClick(HashTripName,global_trip_id);loadTripItemDetail(global_trip_id);}else if(quickNavTripId!=0){tripNameClick(HashTripName,quickNavTripId);loadTripItemDetail(quickNavTripId);}else{hashPushState("My-Trips","Georama - My Trips");loadTripItemDetail();}}
function loadTripItemDetail(tripId){weatherForMytrip='fn';mytripdetailStatus=false;if(xhr!=null){xhr.abort();xhr=null;}
tripPartWidget=false;quickNavTripId=0;resetPanelFlags();$("#trip_list li").removeClass("active");$("#trip_"+tripId).addClass('active');global_trip_id=tripId;document.getElementById("tripPlaceId").value=tripId;if(document.getElementById("add_edit_trip").style.display!='none'){cancelNewTrip();}
var detailUrl='/html5/mytrip/details/';var params='';if(!isNaN(tripId)){params+='t='+tripId;}
params+='&ow='+2;showRightLoader();xhr=$.ajax({type:"GET",url:detailUrl,data:params,success:function(data){hideRightLoader();$("#mytrip_right").html(data);$("#mytrip_right .scrollbar_wrapper").tinyscrollbar({sizethumb:25});if(typeof tripId=='undefined'){tripId=global_trip_id;}
var trip_start_date=$("#trip_start_date").val();var trip_end_date=$("#trip_end_date").val();var weather_city_id=$("#weather_city_id").val();var weather_day_diff=$("#weatherDayDifference").val();if(weather_city_id!='0'){getWeatherForTrip(weather_city_id,trip_start_date,trip_end_date,weather_day_diff);$("#weather_block").show();}else{$("#weather_block").hide();}
$("#item_detail_wrapper").show();$("#details_wrapper").show();}});}
function myTripPanelForBingLevel(){if((visibleMap=='jvector')&&(mapZoomLevel==0)){mapZoomLevel=1;}
if($('.rightPanel').is(":visible")==false){$('.rightPanel').show();}
$('#mytrip_dropdown_lb').text('View all Trips');$('#mytrip_dropdown_ul a').removeClass('active');$('#all_a').addClass('active');$("#StaticPageContent").html('');$('#fareSearch_wrapper').hide();$("#openPage").hide();$(".pageOverlay").hide();showhideWelcomePanel('hide');getTripList();$('#main-top-nav li a').removeClass('active');$('#myTripsId').addClass('active');$('#zoomcontrols').show();}
function myTripDetailView(itemId,tripId,activeU,tab){mytripdetailStatus=true;if(document.getElementById("my_trip_wrapper").style.display!='block'){myTripPanelForBingLevel();}
if(visibleMap=='bing'){$("#bing_attraction_info").hide();}
$("#widget_wrapper").hide();$("#details_wrapper").show();$("#mytrip_item_type").val('0');$("#fr_wrapper").hide();fillItemDetail(itemId,activeU,tab);fillTripItems(0,tripId,function(){$("#item_list_wrapper ul li").removeClass('active');$("#item_list_wrapper ul li#mytripli_"+itemId).addClass('active');});}
function fillTripItems(categoryId,tripId,custFunc){if(dashboardWidget){if(typeof custFunc=='undefined'){$("#item_detail_wrapper").html(preloadDiv);if(tripPartWidget==true){tripPartId=document.getElementById("tripPartId").value;var url='/html5/mytrip/itemlist/c/'+categoryId+'/t/'+tripId+'/ol/1/tp/'+tripPartId;}else{var url='/html5/mytrip/itemlist/c/'+categoryId+'/t/'+tripId+'/ol/1';}}else{if(tripPartWidget==true){var url='/html5/mytrip/itemlist/c/'+categoryId+'/t/'+tripId+'/tp/'+tripPartId;}else{var url='/html5/mytrip/itemlist/c/'+categoryId+'/t/'+tripId;}}}else{var url='/html5/mytrip/friendrecommendlist/c/'+categoryId+'/t/'+tripId;}
$("#item_list_wrapper").html('<div style="padding:80px 0;" align="center">Loading..<br /><img src="/images/preloader.gif" alt=""/></div>');$.ajax({'url':url,'success':function(data){$("#item_list_wrapper").html(data);$('#item_list_wrapper .scrollbar_wrapper').delay(500).tinyscrollbar({sizethumb:25});if(typeof custFunc=='function'){custFunc();}}});if(custFunc){return custFunc();}}
function fillItemDetail(itemId,activeUser,mode){if(mode=='FR'){var url='/html5/mytrip/poi/i/'+itemId+'/u/'+activeUser+'/mode/'+mode+'/tripId/'+global_trip_id;}else{var url='/html5/mytrip/poi/i/'+itemId+'/u/'+activeUser+'/tripId/'+global_trip_id;}
$("#item_detail_wrapper").html(preloadDiv);$.get(url,function(data){deleteitem=itemId;$("#item_detail_wrapper").html(data);$('#item_detail_wrapper .scrollbar_wrapper').delay(500).tinyscrollbar({sizethumb:25});$(".chotelAvailDtFrom").datepicker({inline:true,altField:'#hotelAvailDtFrom',minDate:0,yearRange:'2012:2014',dateFormat:'mm-dd-yy',defaultDate:'+1m',onSelect:function(dateText,inst){getNextDate(dateText,'#hotelAvailDtTo',false);}});$(".chotelAvailDtTo").datepicker({inline:true,altField:'#hotelAvailDtTo',minDate:0,yearRange:'2012:2014',dateFormat:'mm-dd-yy',defaultDate:'+1m 1d',onSelect:function(dateText,inst){}});$(".chotelAvailDtFrom").datepicker("setDate","+1m");$(".chotelAvailDtTo").datepicker("setDate","+1m 1d");imgScroller();});$("#item_list_wrapper ul li").removeClass('active');$("#item_list_wrapper ul li#mytripli_"+itemId).addClass('active');}
function gotoDashboard(){tripPartId=document.getElementById("tripPartId").value;if(dashboardWidget){if(visibleMap=='bing'){zoomTo100();}
if(tripPartWidget==false){loadWidgets(global_trip_id);}else{loadWidgets(global_trip_id,tripPartId);}
$("#details_wrapper").hide();$("#widget_wrapper").show();}else{myTripPanelOnOff('friend',global_trip_id);}}
function georamaNewTrip(){if(anonymousUser==false){$("#hidden_trip_origin").val('');$("#hidden_trip_destination").val('');addNewTrip();}else{anonymousTrip('createTrip');}}
function addNewTrip(){if(visibleMap=='bing'){zoomTo100();}
var url='/html5/mytrip/addedittrip';$.get(url,function(result){$("#add_edit_trip").show();$("#add_edit_trip").html(result);if(result!=''){hashPushState("My-Trips/Create-New-Trip","Georama - My Trips | Create New Trip");$("#delete_trip_btn").hide();$('#create_trip_btn').removeAttr("disabled");map.refreshMultiDestArr();$('#rootvectormap').vectorMap('set','hideAllPin',1);initializeAddEditTrip(true);$("#hdnId").val('');$("#create_trip_btn").html("Create Trip");if(create_new_trip_flag){$("#hdnMode").val('add');$("#create_new_trip_btn").hide();$("#add_edit_trip").show();$("#mytrip_right").hide();}else{$("#add_edit_trip").hide();$("#mytrip_right").show();$("#create_new_trip_btn").show();}
$("#trip_heading").html("Create New Trip");$("#hdnMode").html("add");$("#hdnId").html("");document.frmAddEditTrip.reset();try{$('#rootvectormap').vectorMap('set','hideAllPin',1);if(previous_dynamic_txt_box!=''){removeTripDynamicTxtBox(previous_dynamic_txt_box);}}catch(err){}
getPotientialDestination('');}});}
function loadMyTripForm(){var params='';var url='/html5/mytrip/addedittrip';$.ajax({type:"GET",url:url,data:params,async:false,success:function(result){$("#add_edit_trip").html(result);$("#add_edit_trip").show();}});}
function getPotientialDestination(tripId,param){document.getElementById("trip_potiential_destination").innerHTML='<div style="padding-top:15px;" align="center">Loading..<br /> <img src="/images/preloader.gif" alt=""/></div>';var url='';if(!isNaN(tripId)){url='/html5/mytrip/getpotientialdestination/tripId/'+tripId+'/param/'+param+'/rand/'+parseInt(Math.random()*99999999);}else{url='/html5/mytrip/getpotientialdestination/param/'+param+'/rand/'+parseInt(Math.random()*99999999);}
$.get(url,function(data){$("#trip_potiential_destination").html(data);});}
function getWeatherForTrip(city,startDate,endDate,weather_day_diff){if(weather_day_diff<7){endDate='';}
$("#my_trip_weather").html('<div style="padding-top:15px;" align="center">Loading..<br /> <img src="/images/preloader.gif" alt=""/></div>');if(city){var url='/html5/plan/getweatherfortrip/city/'+city+'/startDate/'+startDate+'/endDate//tripId/'+global_trip_id+'/ttype/'+weatherForMytrip+'/rand/'+parseInt(Math.random()*99999999);$.get(url,function(data){$("#my_trip_weather").html(data);exchangeWeatherInformation(weatherForMytrip);});}else{$("#my_trip_weather").html('');}}
function getWeatherWidget(city,startDate,endDate,weather_day_diff,mode){var WidgetID,filltripID;if(mode=='mytrip'){WidgetID='my_trip_weather_widget';filltripID=global_trip_id;}
else if(mode=='friendtrip'){WidgetID='friend_trip_weather_widget';filltripID=friend_global_trip_id;}
if(weather_day_diff<7){}
$("#"+WidgetID).html('<div style="padding-top:65px;" align="center"><img src="/images/preloader.gif" alt=""/></div>');if(city){var url='/html5/mytrip/get-weather-widget/city/'+city+'/startDate/'+startDate+'/endDate//tripId/'+filltripID+'/ttype/'+weatherForMytrip+'/rand/'+parseInt(Math.random()*99999999);$.get(url,function(data){if(data!=''){$("#"+WidgetID).html(data);if(weatherForMytrip=='fn'){$(".weatherInCelc").hide();$(".weatherInfarn").show();}else{$(".weatherInCelc").show();$(".weatherInfarn").hide();}}
else{}});}
else{}}
function exchangeWeatherInformation(info){if(info=="fn"){$('.temp_f').removeClass('farn').addClass('farn_active');$('.temp_c').removeClass('celc_active').addClass('celc');$(".weatherInCelc").hide();$(".weatherInfarn").show();weatherForMytrip='fn';}else{$('.temp_c').removeClass('celc').addClass('celc_active');$('.temp_f').removeClass('farn_active').addClass('farn');$(".weatherInCelc").show();$(".weatherInfarn").hide();weatherForMytrip='c';}}
function hideLeftLoader(){$("#mytripsleftloader").hide();}
function hideFriendLeftLoader(){$("#friendtripsleftloader").hide();}
function showLeftLoader(){$("#mytripsleftloader").show();}
function hideRightLoader(){$("#mytripsrightloader").hide();}
function showRightLoader(){$("#mytrip_right").html('');$("#mytripsrightloader").show().css("padding-top","100px");}
function setTripName(text){var tripName=text;var tripNameLen=text.length;if(tripNameLen>13){var name=tripName.substring(0,11)+'..';}else{var name=text;}
document.getElementById("tripPlaceName").innerHTML=name;$('#tripPlaceName').attr('title',text);}
function mytripInit(){$("#my_trips_panel_heading").html('My Trips');if(mytriplist!=null){mytriplist.abort();mytriplist=null;}
var url='/html5/mytrip/list';var params='rand='+parseInt(Math.random()*99999999);mytriplist=$.ajax({type:"GET",url:url,data:params,success:function(data){hideLeftLoader();$("#mytrip_left").html(data);$("#mytrip_left .scrollbar_wrapper").tinyscrollbar({sizethumb:25});}});$("#trip_list li").removeClass("active");var id=$("#tripPlaceId").val();$("#trip_"+id).addClass('active');var HashTripName=$("#tripPlaceName").text();if(global_trip_id!=''){tripNameClick(HashTripName,global_trip_id);loadTripInfo(global_trip_id,'mytrip');}else if(quickNavTripId!=0){tripNameClick(HashTripName,quickNavTripId);loadTripInfo(quickNavTripId,'mytrip');}else{hashPushState("My-Trips","Georama - My Trips");loadTripInfo('undefined','mytrip');}}
function loadTripInfo(tripId,triptype){if(visibleMap=='bing'){zoomTo100();}
weatherForMytrip='fn';if(xhr!=null){xhr.abort();xhr=null;}
tripPartWidget=false;quickNavTripId=0;getStatusCal='';resetPanelFlags();$("#trip_list li").removeClass("active");global_trip_id=tripId;document.getElementById("tripPlaceId").value=tripId;if(document.getElementById("add_edit_trip").style.display!='none'){$("#mytrip_right").show();create_new_trip_flag=true;$("#create_new_trip_btn").show();$("#add_edit_trip").hide();}
var detailUrl='/html5/mytrip/details';var params='';if(!isNaN(tripId)){params+='t='+tripId;params+='&rand='+Math.random();}
showRightLoader();xhr=$.ajax({type:"GET",url:detailUrl,data:params,success:function(data){hideRightLoader();$("#mytrip_right").html(data);$("#mytrip_right .scrollbar_wrapper").tinyscrollbar({sizethumb:25});if(typeof tripId=='undefined'){tripId=global_trip_id;}
if(typeof tripId!='undefined'){showTripPushPin(tripId,triptype);}
var trip_start_date=$("#trip_start_date").val();var trip_end_date=$("#trip_end_date").val();var weather_city_id=$("#weather_city_id").val();var weather_day_diff=$("#weatherDayDifference").val();if(weather_city_id!='0'){$("#weather_block").show();getWeatherForTrip(weather_city_id,trip_start_date,trip_end_date,weather_day_diff);}else{$("#weather_block").hide();}
$("#trip_"+tripId).addClass('active');}});}
function loadWidgets(tripId,tripPartId,panel){weatherForMytrip='fn';if(tripPartId!='undefined'){$(".tripCityName").removeClass('myselect');$("#trip_potential_"+tripPartId).parent().addClass('myselect');$("#trip_origin_"+tripPartId).parent().addClass('myselect');$("#trip_destination_"+tripPartId).parent().addClass('myselect');}
if(dashboardWidget==true||panel=='friend'){if(loadwidgetreq!=null){loadwidgetreq.abort();loadwidgetreq=null;}
if(typeof(tripPartId)=='undefined'||tripPartId==''){tripPartWidget=false;}else{tripPartWidget=true;}
if(mytripdetailStatus==true){document.getElementById("tripPartId").value=tripPartId;fillTripItems(0,tripId);}
var detailUrl='/html5/mytrip/details';var weather_city_id=activeTripPart.cityId;var params='ow=1&t='+tripId+'&tp='+tripPartId+'&cityId='+weather_city_id+'&rand='+Math.random();global_trip_id=tripId;global_trip_part_id=tripPartId;displayLoadingImages();loadwidgetreq=$.ajax({type:"GET",url:detailUrl,data:params,success:function(data){$("#widget_wrapper").html(data);$("img.lazyloading").lazyload({placeholder:"/images/html5/img-lazy-loading.gif",effect:"fadeIn",threshold:400});if(typeof $('#widget_wrapper .scrollbar_wrapper')!='undefined'){$('#widget_wrapper .scrollbar_wrapper').delay(500).tinyscrollbar({sizethumb:25});}}});if(panel=='friend'){dashboardWidget=false;}}else{myTripPanelOnOff('friend',tripId,tripPartId);}}
function displayLoadingImages(){$("#attraction_activity_widget").html('<center><img style="padding-top:70px;" src="/images/preloader.gif"  /></center>');$("#attraction_activity_widget").html('<center><img style="padding-top:70px;" src="/images/preloader.gif"  /></center>');$("#hotel_flight_widget").html('<center><img style="padding-top:70px;" src="/images/preloader.gif"  /></center>');$("#restaurant_nightlife_widget").html('<center><img style="padding-top:70px;" src="/images/preloader.gif"  /></center>');$("#events_deals_widget").html('<center><img style="padding-top:70px;" src="/images/preloader.gif"  /></center>');$("#friends_widget").html('<center><img style="padding-top:70px;" src="/images/preloader.gif"  /></center>');$("#shopping_widget").html('<center><img style="padding-top:70px;" src="/images/preloader.gif"  /></center>');$("#hostel_car_widget").html('<center><img style="padding-top:70px;" src="/images/preloader.gif"  /></center>');$("#my_trip_weather_widget").html('<center><img style="padding-top:70px;" src="/images/preloader.gif"  /></center>');$("#notes_widget").html('<center><img style="padding-top:70px;" src="/images/preloader.gif" /></center></span>');$(".empty_widget").html('<center><img src="/images/preloader.gif"  alt=""/></center>');}
function myTripPanelOnOff(activePanel,tripId,tripPartId){setTripInnerNavigation(activePanel);if(activePanel=='friend'){$("#widget_wrapper").hide();$("#details_wrapper").hide();$("#fr_wrapper").show();$(".point_tab_downb").show();$(".point_tab_down").hide();dashboardWidget=false;if(typeof tripPartId!="undefined"){var url='/html5/mytrip/recommendeditemlist/t/'+tripId+'/tp/'+tripPartId;}else{var url='/html5/mytrip/recommendeditemlist/t/'+tripId;}
$("#fr_wrapper").html(preloadDiv);$.get(url,function(data){$("#fr_wrapper").html(data);var gCtr=document.getElementById("gCtr_Val").value;for(i=1;i<=gCtr;i++){$('.fRecoG'+i).equalizeHeights();}});}else{$("#details_wrapper").hide();$("#widget_wrapper").show();$("#fr_wrapper").hide();$(".point_tab_downb").hide();$(".point_tab_down").show();dashboardWidget=true;if(typeof $('#widget_wrapper .scrollbar_wrapper')!='undefined'){$('#widget_wrapper .scrollbar_wrapper').delay(500).tinyscrollbar({sizethumb:25});}}}
function setTripInnerNavigation(panel){switch(panel){case'my':$("#a_trip_destination").addClass('active');$("#a_friends_recommendations").removeClass('active');$("#a_friends_comments").removeClass('active');break;case'friend':$("#a_friends_recommendations").addClass('active');$("#a_trip_destination").removeClass('active');$("#a_friends_comments").removeClass('active');break;case'comment':$("#a_friends_comments").addClass('active');$("#a_trip_destination").removeClass('active');$("#a_friends_recommendations").removeClass('active');break;}}
function loadFriends(tripId){var detailUrl='/html5/mytrip/friends/t/'+tripId;$.get(detailUrl,function(data){$("#friends_widget").html(data);});}
function removeTripDynamicTxtBox(counter){for(i=counter;i>=1;i--){var spanId="addMoreBlock"+i;if(spanId!=null){$("#addMoreBlock"+i).remove();}}}
function callonCancel(){tid=document.getElementById("tripPlaceId").value;if(tid!=0){url='/html5/mytrip/tripparts/tripId/'+tid+'/rand/'+parseInt(Math.random()*99999999);$.get(url,function(data){cities=data;try{$('#rootvectormap').vectorMap('set','hideAllPin',1);}
catch(err){}
if(cities!=0&&cities!='')
{url='/html5/trip/getmultiplecitypushpin/cityId/'+cities+'/rand/'+parseInt(Math.random()*99999999);$.get(url,function(data){var obj=jQuery.parseJSON(data);$.each(obj.data,function(i,value){try{$('#rootvectormap').vectorMap('set','label',{"n":value.name,"c":value.ccode.toLowerCase(),"d":value.desc,"lat":value.lat,"lon":value.lon,"pin":1,"pcolor":"white","key":value.id,"l":1});}
catch(err){}});});}else{objPoint=$('#rootvectormap').vectorMap('get','selectedPin',1);$('#rootvectormap').vectorMap('set','label',{"n":objPoint.name,"d":objPoint.description,"lat":objPoint.lat,"lon":objPoint.lon,"pin":1,"pcolor":"green","key":objPoint.id,"l":1,"latVar":0,"lonVar":0});}});}}
function editMyTrip(id){if(visibleMap=='bing'){zoomTo100();}
var param='';$("#mytrip_right").hide();loadMyTripForm();if(anonymousSaveTrip==true){param=1;myTripList();}else{global_trip_id=id;}
var tripName=$("#tripPlaceName").html();$(".formErrorContent").hide();$(".formErrorArrow").hide();$("#hdnId").val(id);if(param==1){$("#trip_heading").html('Create New Trip');}else{$("#trip_heading").html('Edit Trip');}
$('#add_more_destination').show();if(tripName=='Untitled Trip'){$("#delete_trip_btn").hide();}else{$("#delete_trip_btn").show();}
$('#create_trip_btn').removeAttr("disabled");if(destination_counter){destination_counter=0;}
$("#user_status").val(param);url='/html5/mytrip/editmytrip/tripId/'+id+'/param/'+param+'/rand/'+parseInt(Math.random()*99999999);$.getJSON(url,function(data){$("#add_edit_trip").show();$("#mytrip_right").hide();if(param==1){$("#mode").val("add");}else{$("#mode").val("edit");$("#create_trip_btn").html("Update Trip");}
$("#tripId").val(data.tripData.trip_id);if(param==1){$("#trip_title").val('');}else{$("#trip_title").val(data.tripData.trip_title);}
$("#trip_title").focus();$("#trip_origin_date").val(data.tripData.trip_origin_date);if(data.tripData.total_parts>1){}else{$("#trip_destination_date").val(data.tripData.trip_destination_date);}
$("#trip_origin").val(data.tripData.trip_origin);$("#traveller").val(data.tripData.no_of_traveller);$("#trip_origin_id").val(data.tripData.hidden_trip_origin);$.each(data.tripParts,function(i,value){try{if(value.sequence==1){$("#trip_destination_id").val(value.cityId);$("#trip_destination").val(value.cityName);$("#trip_destination_date").val(value.fromDate);}else{if(data.tripData.total_parts>1){addTripDestination('edit',value.cityId,value.cityName,value.fromDate);}}}catch(err){}
previous_dynamic_txt_box=parseInt(data.tripData.total_parts)-1;});if(param==1){}else{$("#trip_heading").html('Edit Trip');}
$("#create_new_trip_btn").hide();$("#add_edit_trip").show();var destinationLength=$(".trip_destination_div").length;if(destinationLength==6){$("#add_more_destination").hide();$(".ctrip_destination_date:last").css('visibility','hidden');$(".ctrip_destination_date:last").prev('label').css('visibility','hidden');}});getPotientialDestination(id,param);}
function getAdditionalDestination(destination,destinationArray,destinationIdArray,tripPartInitialIds){for(var i=1;i<=destination;i++){var destination_value=destinationArray[i];var destination_ids=destinationIdArray[i];var newTextBoxSpan=$(document.createElement('span')).attr("id",'TextBoxSpan'+i).attr("class",'block formfield');newTextBoxSpan.html('<input class="text" type="text" onFocus="this.select();" name="txtDestinationSearchCity'+i+'" id="txtDestinationSearchCity'+i+'" value="'+destination_value+'" /><a style="padding-left:5px;" href="javascript:void(0);" onclick="removeDest('+i+')" id="remove_destination'+i+'"><img height="18px;" width="20px;" src="/images/html5/minus-sign.png"  /></a><input type="hidden" class="text" name="hdnDestinationSearchCity" id="hdnDestinationSearchCity'+i+'" value="'+destination_ids+'"/>');newTextBoxSpan.appendTo("#destination_span");destination_counter=i;autoCompleteDestination(destination_counter);}
$("#destination_counter").val(destination_counter);destination_counter++;}
function autoCompleteDestination(counter){var a=$('#trip_destination'+counter).autocomplete1({serviceUrl:'/feed/citysuggest/',minChars:2,maxHeight:400,width:200,zIndex:9999,noCache:false,onSelect:function(value,data){$('#trip_destination'+counter).removeClass('ui-autocomplete-loading');var dataPart=data.split('|');document.getElementById("trip_destination_id"+counter).value=dataPart[3];}});}
function saveTripPart(cityid){if(cityid!=''){if(document.getElementById("my_trip_wrapper").style.display=="block"){myTripFlag=true;}else{myTripFlag=false;}
if(friendTripFlag==false){tripid=document.getElementById("tripPlaceId").value;url='/html5/trip/addtrippart/tripId/'+tripid+'/cityId/'+cityid+'/rand/'+parseInt(Math.random()*99999999);$.get(url,function(data){arrdata=data.split("|||");if(arrdata[0]!=0){global_trip_part_id=arrdata[0];document.getElementById("tripPartId").value=arrdata[0];}});}}}
function getTripPushPinsResult(tid){if(friendTripFlag==false){document.getElementById("tripPlaceId").value=tid;}
if(tid!=0){url='/html5/mytrip/gettrippushpin/tripId/'+tid+'/rand/'+parseInt(Math.random()*99999999);$.get(url,function(data){tripPushpinResult=jQuery.parseJSON(data);if(friendTripFlag==false&&tripDataLoadedOnceViaWelcome==true&&hashLocationURL.length<=1){tripDataLoadedOnceViaWelcome=false;showTripDataOnMap();}else
{tripDataLoadedOnceViaWelcome=false;}
setTimeout(function(){map.updateTripNavigationBar("A","");},2000);});}}
function showTripPushPin(tid,triptype){if(friendTripFlag==false){document.getElementById("tripPlaceId").value=tid;}
if(createTripWelcome==true){$('#rootvectormap').vectorMap('set','hideAllPin',1);createTripWelcome=false;return;}
if(typeof triptype!='undefined'){if(friendTripFlag==true&&triptype!="friend")return;if(friendTripFlag==false&&triptype!="mytrip")return;}
if(tid!=0){$('#rootvectormap').vectorMap('set','hideAllPin',1);url='/html5/mytrip/gettrippushpin/tripId/'+tid+'/rand/'+parseInt(Math.random()*99999999);$.get(url,function(data){if(typeof triptype!='undefined'){if(friendTripFlag==true&&triptype!="friend")return;if(friendTripFlag==false&&triptype!="mytrip")return;}
var result=jQuery.parseJSON(data);if(result.attempt=='success'){if(result.data!=0){plotPushpinsOnVectorMap(result);}else{map.refreshMultiDestArr();$('#rootvectormap').vectorMap('set','label',{"key":0});}
map.updateTripNavigationBar("A","");if($('#main-top-nav li a.active').attr('id')=='homeLink'){$('#rootvectormap').vectorMap('set','hideAllPin',1);}}else{$('#rootvectormap').vectorMap('set','hideAllPin',1);map.refreshMultiDestArr();map.updateTripNavigationBar("A","");}});}}
function anonymousTripPushPin(tid){if(friendTripFlag==false){document.getElementById("tripPlaceId").value=tid;}
if(tid!=0){url='/html5/mytrip/gettrippushpin/tripId/'+tid+'/rand/'+parseInt(Math.random()*99999999);$.get(url,function(data){var result=jQuery.parseJSON(data);if(result.data!=0){plotPushpinsOnVectorMap(result);}else{$('#rootvectormap').vectorMap('set','label',{"key":0});map.updateTripNavigationBar("A","");}});}}
var maxDestinationPushPin=6;var destPushPinCounter=0;var originCityId="";var preOrgCtId="";function plotPushpinsOnVectorMap(result){var destinationCityId=0;var pdCityId=0;var pdCounter=0;preOrgCtId="";destPushPinCounter=0;map.multiDestArr=[];map.refreshTrajDestArr();$.each(result.data,function(i,value){if(value.cityType=='origin'){$('#rootvectormap').vectorMap('set','label',{"n":value.name,"c":value.ccode.toLowerCase(),"d":value.description,"lat":value.lat,"lon":value.lon,"pin":1,"pcolor":"green","key":value.id,"l":5,"latVar":value.latVar,"lonVar":value.lonVar});originCityId=value.id;}else if(value.cityType=='destination'){destPushPinCounter++;$('#rootvectormap').vectorMap('set','label',{"n":value.name,"c":value.ccode.toLowerCase(),"d":value.description,"lat":value.lat,"lon":value.lon,"pin":1,"pcolor":"blue","key":value.id,"l":5,"latVar":value.latVar,"lonVar":value.lonVar});destinationCityId=value.id;destinationFlag=true;map.multiDestArr.push(destinationCityId);}else if(value.cityType=='potential'){if(pdCounter==0){pdCityId=value.id;}
$('#rootvectormap').vectorMap('set','label',{"n":value.name,"c":value.ccode.toLowerCase(),"d":value.description,"lat":value.lat,"lon":value.lon,"pin":1,"pcolor":"white","key":value.id,"l":5,"latVar":value.latVar,"lonVar":value.lonVar});pdCounter++;}});if(typeof map.multiDestArr!='undefined'){if(map.multiDestArr.length>0)
destinationCityId=map.multiDestArr[0];}
if(destinationCityId!=0){map.makeCitySelected(destinationCityId,'');}else if(pdCityId!=0){map.makeCitySelected(pdCityId,'');}
if(friendTripFlag==false){map.updateTripNavigationBar("A","");}
map.setMultiDestList();originCityId="";map.callCityNameHandling();}
function plotPushpinsOnVectorMapByType(type,result){switch(type){case'destination':$('#rootvectormap').vectorMap('set','label',{"n":result.geo_city_name,"c":result.geo_country_code.toLowerCase(),"d":'',"lat":result.geo_lat,"lon":result.geo_lon,"pin":1,"pcolor":"blue","key":result.geo_city_id,"l":5,"latVar":result.geo_lat_varience,"lonVar":result.geo_lon_varience});break;}}
function myTripNavigation(param){switch(param){case'current':$('#currentul').show();$('#upcomingul').hide();$('#pastul').hide();$("#trip_list li").removeClass("active");break;case'upcoming':$('#upcomingul').show();$('#currentul').hide();$('#pastul').hide();$("#trip_list li").removeClass("active");break;case'past':$('#pastul').show();$('#upcomingul').hide();$('#currentul').hide();$("#trip_list li").removeClass("active");break;case'all':myTripList();break;}
$('#mytrip_left .scrollbar_wrapper').tinyscrollbar({sizethumb:25});$('#mytrip_dropdown_ul').hide();setFirstTripSelected(param);}
function setFirstTripSelected(param){var msgHtml='<div style="padding-top:190px;padding-right:190px" id=""><center><h6 style="color: rgba(32, 87, 145, 0.9); font-size: 18px;">No '+param+' trip found.</h6></center><br></div>';switch(param){case'current':var tempElement=$("#currentul ul li:first-child");var childCount=$('#currentul ul > li').length;break;case'upcoming':var tempElement=$("#upcomingul ul li:first-child");var childCount=$('#upcomingul ul > li').length;break;case'past':var tempElement=$("#pastul ul li:first-child");var childCount=$('#pastul ul > li').length;break;case'all':var tempElement=$("#currentul ul li:first-child");var childCount=$('#currentul ul > li').length;break;}
if(typeof tempElement!='undefined'&&childCount>0){$('a',$(tempElement)).trigger('click');}
if(typeof tempElement=='undefined'||childCount<1){$("#mytrip_right").html(msgHtml);}}
function myTripSharePopUp(id){switch(id){case 1:if(document.getElementById("facebookShare").style.display=="none"){$("#facebookShare").show();}else{$("#facebookShare").hide();}
$("#twitterShare").hide();$("#sendEmail").hide();break;case 2:if(document.getElementById("twitterShare").style.display=="none"){$("#twitterShare").show();}else{$("#twitterShare").hide();}
$("#facebookShare").hide();$("#sendEmail").hide();break;case 3:if(document.getElementById("sendEmail").style.display=="none"){$("#sendEmail").show();}else{$("#sendEmail").hide();}
$("#twitterShare").hide();$("#facebookShare").hide();break;}}
function shareMyTripWithFacebook(){var message=$("#facebook_share_message").val();var description;var picture;var caption;var name;var link1;var actions;var url='/fbapi/wallpost/m/'+message+'/d/'+description+'/p/'+picture+'/c/'+caption+'/n/'+name+'/l/'+link1+'/a/'+actions+'/rand/'+parseInt(Math.random()*99999999);$.get(url,function(data){myTripSharePopUp();});}
function shareMyTripWithTwitter(){var message=$.trim($("#twitter_share_message").val());twitterPost(message);}
function sendTripEmail(){var to=$.trim($("#share_to").val());var subject=$.trim($("#share_subject").val());var message=$.trim($("#email_share_message").val());var url='/mail/index/to/'+to+'/subject/'+subject+'/message/'+message+'/rand/'+parseInt(Math.random()*99999999);$.get(url,function(data){myTripSharePopUp();});}
function addTripDestination(from,cityId,cityName,fromDate){var addMoreBlockHtml='';trip_flag=true;destination_counter=$('.trip_destination_div').length;if(destination_counter==0){destination_counter=1;}
else if(destination_counter>=6){notifyme('Maximum 6 Destinations are allowed for a single trip!','error');return false;}
var destinationLength=$(".trip_destination_div").length;if(destinationLength>=5){$('#add_more_destination').hide();}
else $('#add_more_destination').show();var destinationCityId='';var destinationCityName='Enter City or Location';var destinationFromDate='';if(typeof(from)!='undefined'){destinationCityId=cityId;destinationCityName=cityName;destinationFromDate=fromDate;}
var addMoreBlock=$(document.createElement('div')).attr("id",'addMoreBlock'+destination_counter).attr("class",'trip_destination_div');addMoreBlockHtml+='<div class="fl mright_10">';addMoreBlockHtml+='<label>Destination</label>';addMoreBlockHtml+='<input type="text" tabindex="6" class="trip_destination_city" onfocus="this.value = (this.value == \'Enter City or Location\') ? \'\' : this.value" onblur="this.value=(this.value==\'\') ? \'Enter City or Location\' : this.value;" autocomplete="off" size="28" id="trip_destination'+destination_counter+'" value="'+destinationCityName+'" />';addMoreBlockHtml+='<br /><span id="trip_destination_error'+destination_counter+'" style="color:red"></span>';addMoreBlockHtml+='<input type="hidden" class="text" name="trip_destination_id[]" id="trip_destination_id'+destination_counter+'" value="'+destinationCityId+'" />';addMoreBlockHtml+='<input type="hidden" class="text" name="trip_part_id[]" id="trip_part_id'+destination_counter+'" value="" />';addMoreBlockHtml+='</div>';addMoreBlockHtml+='<div class="fl" style="width:152px;">';addMoreBlockHtml+='<label>Leaving</label>';addMoreBlockHtml+='<input type="text" tabindex="6" size="13" id="trip_destination_date'+destination_counter+'" name="trip_destination_date[]" value="'+destinationFromDate+'" class="calendar ctrip_destination_date fl" />';addMoreBlockHtml+='&nbsp;<a style="padding-left:5px;" href="javascript:void(0);" onclick="removeTripDestination(this);">';addMoreBlockHtml+='<img src="/images/html5/icons/icon_close.png" alt="" class="vm" style="margin-top:5px;" />';addMoreBlockHtml+='</a>';addMoreBlockHtml+='<br /><span id="trip_destination_date_error'+destination_counter+'" style="color:red"></span>';addMoreBlockHtml+='</div><div class="clearfloat"></div>';addMoreBlock.html(addMoreBlockHtml);$(".trip_destination_div:last").after(addMoreBlock);destinationLength=$(".trip_destination_div").length;if(destinationLength>5){$(".ctrip_destination_date:last").css('visibility','hidden');$(".ctrip_destination_date:last").prev('label').css('visibility','hidden');}
assignDatePickerToDestination(destination_counter);autoCompleteDestination(destination_counter);destination_counter++;if(destinationLength>1){$('.trip_destination_div:first label:last').text('Leaving');}}
function setDatePicker(minDate,destination_counter){if((minDate!='')||(typeof(minDate)!='undefined')){}else{minDate=0;}
var txtControlId='#trip_destination_date'+destination_counter;$(txtControlId).datepicker("option","minDate",minDate);}
function areDatesSorted(timeSeries,cdate,counter){if(timeSeries.length<2){return true;}
var flag1=0;for(var i=0;i<counter;i++){if(timeSeries[i]!=''&&typeof timeSeries[i]!='undefined'){if(!ValidateReservationDates(timeSeries[i],cdate,'createTrip')){flag1=1;break;}}}
if(flag1==0){for(var j=counter+1;j<timeSeries.length;j++){if(timeSeries[j]!=''&&typeof timeSeries[j]!='undefined'){if(!ValidateReservationDates(cdate,timeSeries[j],'createTrip')){flag1=1;break;}}}}
if(flag1==1){return false;}
return true;}
function assignDatePickerToDestination(destination_counter){var txtControlId='#trip_destination_date'+destination_counter;var $_this_minDate=0;if(destination_counter==0){txtControlId='#trip_origin_date';}
$(txtControlId).datepicker({inline:true,yearRange:'2012:2014',dateFormat:'mm-dd-yy',defaultDate:'+1m',maxDate:'+1y',beforeShow:function(dateText,inst){var count=$(txtControlId).attr('id').replace('trip_destination_date','');if(count==''){$_this_minDate=$("#trip_origin_date").val();}
else if(count==1){$_this_minDate=$("#trip_destination_date").val();}
else if(count>1&&count<=6){$_this_minDate=$("#trip_destination_date"+(count-1)).val();}
if($_this_minDate==''||$_this_minDate==null||$_this_minDate==undefined){var datesSeriesArr=[];datesSeriesArr=cleanArray(populateEditTripdates());var lastele=datesSeriesArr.pop();$_this_minDate=lastele;}
$(txtControlId).datepicker('option','minDate',$_this_minDate);},onSelect:function(dateText,inst){activeTripLeavingDate2=dateText;var datesSeries=[];datesSeries=populateEditTripdates();var flag=areDatesSorted(datesSeries,dateText,destination_counter);if(!flag){notifyme('Please enter correct leaving dates.','error');}}});}
function populateEditTripdates(){var datesSeriesArr=[];datesSeriesArr=[$("#trip_origin_date").val(),$("#trip_destination_date").val(),$("#trip_destination_date1").val(),$("#trip_destination_date2").val(),$("#trip_destination_date3").val(),$("#trip_destination_date4").val()];return datesSeriesArr;}
function deleteTripDestinations(tripPartId,cid){if(deleteTripPartRoute(tripPartId,cid,$(this).parent())==true){}}
function deleteTripPart(cId,pId){var partId=0;if((typeof(pId)!='undefined')||(pId!='')){partId=parseInt(pId);}
tripId=parseInt(document.getElementById("tripPlaceId").value);$.ajax({type:"POST",url:'/html5/mytrip/delete-trip-info/tId/'+tripId+'/cId/'+cId+'/pId/'+partId+'/sid/'+parseInt(Math.random()*99999999),async:true,success:function(data){result=jQuery.parseJSON(data);if(result.attempt=='success'){updateMyTripItinerary(result,tripId);}}});}
function deleteDestTripPart(cId,destinationStr){tripId=parseInt(document.getElementById("tripPlaceId").value);if((destinationStr!='')&&(tripId!=0)){$.ajax({type:"POST",url:'/html5/mytrip/delete-trip-info/tId/'+tripId+'/cId/'+cId+'/seq/'+destinationStr+'/sid/'+parseInt(Math.random()*99999999),async:true,success:function(data){result=jQuery.parseJSON(data);if(result.attempt=='success'){updateMyTripItinerary(result,tripId);}}});}else{return false;}}
function updateMyTripItinerary(jsonResponse,tripid){if(jsonResponse.data.cityId!=0){activeTripPart.cityId=jsonResponse.data.cityId;activeTripPart.cityName=jsonResponse.data.cityName;activeTripPart.tripPartId=jsonResponse.data.tripPartId;document.getElementById("tripPartId").value=jsonResponse.data.tripPartId;if(anonymousUser==true){$("#save_new_trip_btn").show();}}else{activeTripPart.cityId=0;activeTripPart.cityName='';activeTripPart.tripPartId=0;$("#explore_more_places").hide();if(anonymousUser==true){$("#save_new_trip_btn").hide();}}
if(document.getElementById("my_trip_wrapper").style.display=="block"){if(anonymousUser==false){loadWidgets(tripid,'');}
var deletedCityType='';if(typeof jsonResponse.data.deletedCityType!='undefined'){deletedCityType=jsonResponse.data.deletedCityType;}
updateTripRouteList(tripid,deletedCityType);}}
function deleteTripPartRoute(partId,cid,param,sequence){tripid=document.getElementById("tripPlaceId").value;if(typeof sequence=="number"){map.deleteDestinationFromPanel(cid,sequence);return true;}else{if(partId){map.deletePushPin(cid);if(param!=''){}
return true;}else{return false;}}}
MULTICITY={interchangeTripSeq:function(newSeq){var tripId=$("#tripPlaceId").val();if((newSeq!='')&&(tripId!='0')){var myURL='/html5/mytrip/interchange-seq/';myURL+='seq/'+newSeq;myURL+='/tripId/'+tripId;myURL+='/rand/'+Math.random();$.ajax({url:myURL,success:function(response){var result=jQuery.parseJSON(response);if(result.attempt=='success'){updateTripRouteList(tripId,'');}},error:function(){alert("fail :(");}});}else{return false;}}}
function deleteAllTripParts(){tripid=document.getElementById("tripPlaceId").value;if(tripid){$.ajax({type:"POST",url:'/html5/mytrip/delete-trip-info/tId/'+tripid+'/parts/1/sid/'+parseInt(Math.random()*99999999),async:true,success:function(data){result=jQuery.parseJSON(data);if(result.attempt=='success'){$('#rootvectormap').vectorMap('set','hideAllPin',1);updateTripRouteList(tripid,'');if(anonymousUser==false){loadWidgets(tripid,'');}
if(anonymousUser==true){$("#save_new_trip_btn").show();}}}});}else{return false;}}
function removeTripDestination($_object){$($_object).parent().parent().remove();var destinationLength=$(".trip_destination_div").length;if(destinationLength<6){$('#add_more_destination').show();$(".ctrip_destination_date:last").css('visibility','visible');$(".ctrip_destination_date:last").prev('label').css('visibility','visible');}
for(var c=0;c<destinationLength;c++){if(c!=0){$('.trip_destination_div:eq('+c+')').attr('id','addMoreBlock'+(c));$('.trip_destination_div:eq('+c+')').find('input.trip_destination_city').attr('id','trip_destination'+(c));$('.trip_destination_div:eq('+c+')').find('span').attr('id','trip_destination_error'+(c));$('.trip_destination_div:eq('+c+')').find('input.text').attr('id','trip_destination_id'+(c));assignDatePickerToDestination(c);}}
if(destinationLength==1){$('.trip_destination_div:first label:last').text('Returning');}}
function removeDest(id){var remove_city_txt_id="hdnDestinationSearchCity"+id;remove_city_id=document.getElementById(remove_city_txt_id).value;$('#rootvectormap').vectorMap('set','removePushpin',remove_city_id);$("#TextBoxSpan"+id).remove();if(destination_counter>1){destination_counter--;}
$("#destination_counter").val(destination_counter);if(previous_dynamic_txt_box!=''){deleteTripPart(remove_city_id);}}
function cancelMyTrip(){document.frmAddEditTrip.reset();if(destination_counter>=1){destination_counter=0;}
$("#add_edit_trip").hide();$("#mytrip_right").show();create_new_trip_flag=true;if(previous_dynamic_txt_box){removePreviousDynamicTxtBox(previous_dynamic_txt_box);}else{}
$("#create_new_trip_btn").show();$('#create_trip_btn').removeAttr("disabled");}
function cancelNewTrip(){$("#add_edit_trip").hide();$("#mytrip_right").show();create_new_trip_flag=true;$("#create_new_trip_btn").show();loadTripInfo(global_trip_id);}
function initializeAddEditTrip(newTrip){var destinationLength=$(".trip_destination_div").length;if(newTrip){if(destinationLength>1){for(i=destinationLength;i>=1;i--){var val=$("#trip_destination"+i).val();$("#addMoreBlock"+i).remove();}}}else{if(destinationLength>1){for(i=destinationLength;i>=1;i--){var val=$("#trip_destination"+i).val();if(val==''){$("#addMoreBlock"+i).remove();}}}}
previous_dynamic_txt_box='';}
function saveMyTrip(){$('#frmAddEditTrip').validationEngine();scrollbar();$(window).resize(function(){$('#frmAddEditTrip').validationEngine('updatePromptsPosition')});var formValid=$('#frmAddEditTrip').validationEngine('validate');$(".formErrorContent").show();$(".formErrorArrow").show();if(!formValid)
return;var destinationLength=$(".trip_destination_div").length;if(validateForm()){for(i=destinationLength-1;i>=1;i--){if(i==1){var previousHdnVal=$("#trip_destination_id").val();var destinationHdnVal=parseInt(i);var destinationHdnVal=$("#trip_destination_id"+destinationHdnVal).val();if(previousHdnVal=='Enter City or Location'){previousHdnVal='';}
if(destinationHdnVal=='Enter City or Location'){destinationHdnVal='';}
if((destinationHdnVal==previousHdnVal)&&(destinationHdnVal!=''&&previousHdnVal!='')){notifyme("Consecutive destinations cannot be same. Please choose a different city name!!","error");return false;}}else{var destinationHdnVal=$("#trip_destination_id"+i).val();var previousVal=parseInt(i-1);var previousHdnVal=$("#trip_destination_id"+previousVal).val();if(previousHdnVal=='Enter City or Location'){previousHdnVal='';}
if(destinationHdnVal=='Enter City or Location'){destinationHdnVal='';}
if((destinationHdnVal==previousHdnVal)&&(destinationHdnVal!=''&&previousHdnVal!='')){notifyme("Consecutive destinations cannot be same. Please choose a different city name!!","error");return false;}}}
if(destinationLength>1){var prevVal=$("#trip_destination_id").val();if(prevVal=='Enter City or Location'){prevVal='';}
for(i=1;i<destinationLength;i++){var destinationVal=$("#trip_destination"+i).val();var destinationHdnVal=$("#trip_destination_id"+i).val();if(typeof(destinationHdnVal)!='undefined'){if(prevVal==destinationHdnVal){$("#addMoreBlock"+i).remove();}
if((destinationVal=='')||(destinationVal=='0')||destinationVal=='Enter City or Location'){$("#addMoreBlock"+i).remove();}
prevVal=$("#trip_destination_id"+i).val();}}}
var destinationVal=$("#trip_destination").val();if((destinationVal=='Enter City or Location')||(destinationVal=='')){$("#trip_destination_id").val('');$("#trip_destination_date").val('');$("#addMoreBlock").remove();}
var formData=$("#frmAddEditTrip").serialize();var tripUrl='/html5/mytrip/savemytrip';$.ajax({type:"GET",data:formData,url:tripUrl,async:true,success:function(data){var result=jQuery.parseJSON(data);if(result.attempt=='success'){$('#trip_change_text').show();$("ul.topnav li span").show();global_trip_id=result.data.tripId;$("#tripPlaceId").val(result.data.tripId);$("#tripPlaceName").text(result.data.tripName);$('#tripPlaceName').attr('title',result.data.tripName);notifyme(result.message,"success");getMyTripList();if(global_trip_id){tripNameClick(result.data.tripName,global_trip_id);loadInitialTrip();$("#tripItemSourceIds").val('');$("#tripItemIds").val('');}}else{notifyme(result.message,"error");}}});}else{$('#create_trip_btn').removeAttr("disabled");return false;}}
function loadInitialTrip(){destination_counter=1;mytripInit();$("#add_edit_trip").hide();$("#mytrip_right").show();$("#create_new_trip_btn").show();}
function saveNewTrip(){}
function addPotentialDestination(tripPartId,cityId,cityName){var destinationLength=$(".trip_destination_div").length;if(destinationLength>4){$('#add_more_destination').hide();alert("Only 5 destinations is allowed for a single trip!");return false;}else{var tripDestination=$("#trip_destination").val();if(tripDestination=='Enter City or Location'){$("#trip_destination").val(cityName);$("#hidden_trip_destination").val(cityId);}else{$("#trip_destination").val(cityName);$("#hidden_trip_destination").val(cityId);}
potentialFlag=true;if(document.getElementById("my_trip_wrapper").style.display=="block"){}
updatePotientialCityType(tripPartId,'destination');}}
function removePreviousTxtBox(){var destinationLength=$(".trip_destination_div").length;if(destinationLength>1){for(i=1;i<destinationLength;i++){var destinationVal=$("#trip_destination"+i).val();if((destinationVal=='')||(destinationVal=='0')||(destinationVal=='Enter City or Location')){$("#addMoreBlock"+i).remove();}}}}
function addAsDestination(cityId,cityName,from){var destinationLength=$(".trip_destination_div").length;var tripDestination=$("#trip_destination").val();if((tripDestination=='Enter City or Location')){$("#trip_destination").val(cityName);$("#trip_destination_id").val(cityId);}else{if(destinationLength==1){var pCityName=$("#trip_destination").val();if(cityName==pCityName){notifyme("You have already added this city as a destination. Please select another one.","error");return false;}}else{var flag;$(".trip_destination_div .trip_destination_city").each(function(){if($(this).val()==cityName){notifyme("You have already added this city as a destination. Please select another one.","error");flag=1;}});if(flag)
return false;}
removePreviousTxtBox();addTripDestination(from,cityId,cityName,'');}
if(from==1){}else if(from==2){}else if(from==3){}else{return false;}}
function updatePotientialCityType(tripPartId,ctype){var cityId=$("#hidden_trip_destination").val();url='/html5/mytrip/updatecitystatus/tpi/'+tripPartId+'/ctype/'+ctype+'/tripId/'+global_trip_id+'/ctId/'+cityId+'/rand/'+parseInt(Math.random()*99999999);$.get(url,function(data){getPotientialDestination(global_trip_id);});}
function getConsideringTripCity()
{}
var error=0;function validateForm(){var trip_title=$('#trip_title').val();var trip_origin=$('#trip_origin').val();var trip_destination=$('#trip_destination').val();if(trip_title=='Untitled Trip'||trip_title=='Untitled trip'||trip_title=='untitled trip'){notifyme("Please choose different trip title!","error");$('#notifyme').css("top",'115px').css("left",'325px');error=1;return false;}
if(trip_title.length>50){notifyme("Trip name can not exceed more than 30 char!","error");error=1;return false;}
originAvailability=trip_origin.search("Can not find");if(originAvailability!='-1'){$('#trip_origin_error').html("Please enter correct city name!");error=1;return false;}
if(trip_origin=='Enter City or Location'||trip_origin==''){$('#trip_origin_id').val('');}else{error=0;$('#trip_origin_error').html('');}
if(trip_destination=='Enter City or Location'||trip_destination==''){$('#trip_destination_id').val('');}
var trip_origin_id=$('#trip_origin_id').val();var trip_destination_id=$('#trip_destination_id').val();if((trip_origin_id!=''&&trip_destination_id!='')&&(trip_origin_id==trip_destination_id)){notifyme("Origin and Destination cannot be same in One-Way Trip. Please choose a different city name!","error");error=1;return false;}
if(trip_title==''){$('#trip_name_error').html("Please enter trip name!");error=1;}else{error=0;$('#trip_name_error').html('');}
if(error){return false;}else{return true;}}
function setItemPriority(itemId,priority){var url='';var url='/html5/mytrip/setitempriority/i/'+parseInt(itemId)+'/p/'+parseInt(priority)+'/rand/'+parseInt(Math.random()*99999999);$.getJSON(url,function(result){setSelectedPriority(result.data.priority);$("#must_vote").html(result.data.must);$("#should_vote").html(result.data.should);$("#could_vote").html(result.data.could);});}
function setFriendItemPriority(itemId,priority){var url='';var url='/html5/friendtrip/setitempriority/i/'+parseInt(itemId)+'/p/'+parseInt(priority)+'/rand/'+parseInt(Math.random()*99999999);$.getJSON(url,function(result){setSelectedPriority(result.data.priority);$("#must_vote").html(result.data.must);$("#should_vote").html(result.data.should);$("#could_vote").html(result.data.could);});}
function setSelectedPriority(id){for(i=1;i<=3;i++)
{if(i==id)
{$("#priority_"+i).addClass("selected");}else{$("#priority_"+i).removeClass("selected");}}}
function saveNotes(notes,itemId){if(notes=='Start typing Notes here'){notifyme("Please enter notes!","error");}else if(notes!=''){$.post("/mytrip/savenotes",{notes:notes,i:itemId},function(data){$('.notes_enabled').hide();$('.notes_disabled').show();notifyme("Notes have been saved successfully!","success");});}else{notifyme("Please enter notes!","error");$("#mytrip_notes").focus();}}
function saveTripNotes(notes,tripId){if(notes!=''){$.post("/mytrip/savetripnotes",{notes:notes,t:tripId},function(data){if(data.attempt=='success'){$('.notes_enabled').hide();$('.notes_disabled').show();notifyme('Trip notes have been saved successfully!',"success");}else{notifyme('You must login to save this notes!',"error");}});}else{notifyme('Please enter notes!',"error");}}
function removeSavedNotes(notes,tripId){if(notes!=''){notes='';$('#mytrip_dashboard_notes').val('');$.post("/mytrip/savetripnotes",{notes:notes,t:tripId},function(data){if(data.attempt=='success'){$('.notes_enabled').show();$('.notes_disabled').hide();notifyme('Trip notes have been removed successfully!',"success");}else{notifyme('You must login to save this notes!',"error");}});}}
function deleteMyTrip(){var id=$("#hdnId").val();var tripId=parseInt(id);if(tripId){$.post("/mytrip/deletetrip",{tid:tripId},function(data){if(data==1){notifyme('Trip has been deleted successfully!',"success");}});}}
function deleteTrip(tid){if(typeof tid=='undefined'){tid=$("#tripPlaceId").val();}
$("#delete_trip_dialog").dialog({resizable:false,draggable:false,height:140,modal:true,dialogClass:'georama_dialog',buttons:{"Yes":function(){if(tid){var tripId=parseInt(tid);}else{var id=$("#hdnId").val();var tripId=parseInt(id);}
if(tripId){$.ajax({type:"POST",url:'/html5/mytrip/deletetrip/tid/'+tripId+'/sid/'+parseInt(Math.random()*99999999),async:true,success:function(result){var response=jQuery.parseJSON(result);if(response.attempt=='success'){notifyme(response.message,"success");getMyTripList();myTripFlag=false;global_trip_id='';quickNavTripId='';if(response.activeTrip!=''){$("#tripPlaceName").html(response.activeTrip);$('#tripPlaceName').attr('title',response.activeTrip);global_trip_id=response.activeId;}
$("#myTripsId").trigger('click');$('#rootvectormap').vectorMap('set','hideAllPin',1);}else{notifyme(response.message,"error");}}});}
$(this).dialog("close");},Cancel:function(){$(this).dialog("close");}},open:function(event,ui){resetDialogZIndex();$(document).bind('scroll',function(){window.scrollTo(0,0);$(".ui-widget.ui-dialog").css({'top':'280px'});});},close:function(event,ui){$(document).unbind('scroll');}});}
function saveUserReviewForItem(itemId){var reviewText=$("#review_text_detail").val();reviewText=$.trim(reviewText);if(reviewText!=''){$.post("/mytrip/saveuserreview",{reviewText:reviewText,itemId:itemId},function(data){alert("Review Saved successfully");});}else{return false;}}
var quickNavigationFlag=true;function getMyTripList(){if(quickNavigationFlag){hideTopNavSettings();url='/html5/mytrip/gettriplist/rand/'+parseInt(Math.random()*99999999);$.get(url,function(data){try{var count=0;if(data!=''){arr=data.split("|||");quickNavigationFlag=true;$("#subnav").html(arr[0]);count=arr[1];}
var PDListingHTMLString;if(count<=6){PDListingHTMLString='<div id="mytripListResult"> \
           <div id="tag-cityResult"> \
           <ul style="height:auto;">'+arr[0]+'</ul></div></div>';}else{PDListingHTMLString='<div class="scrollbar_wrapper"><div class="scrollbar"><div class="thumb"></div></div> \
          <div class="viewport" style="height:155px;"><div class="overview" style="top: 0px;"> \
          <div id="tag-cityResult"> \
           <ul style="height:155px;">'+arr[0]+'</ul></div></div></div></div>';}
$("#topNavTripList").html(PDListingHTMLString);$('#topNavTripList .scrollbar_wrapper').tinyscrollbar({sizethumb:25});}
catch(err){}});$('#topNavigationDestList .scrollbar_wrapper').tinyscrollbar({sizethumb:25});}else{return false;}}
function showMyTripList(){if($("#topNavTripList").is(":visible")==true){$("#topNavTripList").hide();return;}
$("#origin-drop-widget").hide();$("#destination-drop-widget").hide();$("#pot-destination-drop-widget").hide();$("#multi-destination-drop-widget").hide();if($.trim($("#hdn-Pot-Destination-Counter-Open").val())!=""){$("#pot-destination-drop-widget_"+$("#hdn-Pot-Destination-Counter-Open").val()).hide();}
if($.trim($("#hdn-CityKey-Open").val())!=""){if($("#a-top-nav-setting_"+$("#hdn-CityKey-Open").val()).attr("class")=="sel-loc-button select"){$("#a-top-nav-setting_"+$("#hdn-CityKey-Open").val()).attr("class","sel-loc-button");}
$("#hdn-CityKey-Open").val("");}
$('.help ').hide();$('.select_citymsg').hide();$("#topNavTripList").show();if(typeof $('#topNavTripList .scrollbar_wrapper')!='undefined'){$('#topNavTripList .scrollbar_wrapper').tinyscrollbar({sizethumb:25});}}
function acceptFriendRecommendItem(itemId,tripId,tab){var url='';if(itemId){url='/html5/mytrip/acceptrecommendation/id/'+itemId+'/tripId/'+tripId+'/rand/'+parseInt(Math.random()*99999999);$.getJSON(url,function(result){if(result.attempt=='success'){notifyme("Item added successfully to your trip","success");loadWidgets(tripId,'','friend');$('#FR_'+itemId).addClass('done');document.getElementById('FR_'+itemId).innerHTML='Accepted';if(tab=='FR_details'){document.getElementById('FRdetail_'+itemId).innerHTML='<div class="done"> Accepted </div></span>';}}else{notifyme(result.message,"error");}});}else{notifyme('Please select the Item',"error");}}
function openEmailContainter(){$("#span_email_Right_bar").trigger('click');}
function backToTripFromExplore(){abortAjaxCall();showVectorMap();zoomTo100();if(friendTripFlag){showhideTopBar('hide');hashPushState("Friends-Trips","Georama - Friends Trips");openFriendTrips();$('#main-top-nav li a').removeClass('active');$('#friendsTripsId').addClass('active');}else{hashPushState("My-Trips","Georama - My Trips");openMyTabInfo();$('#main-top-nav li a').removeClass('active');$('#myTripsId').addClass('active');}
surfMode='';$('#mapOverlay').hide()}
function addNewTripFrmWC(){hashPushState("My-Trips/Create-New-Trip","Georama - My Trips | Create New Trip");$("#delete_trip_btn").hide();$('#create_trip_btn').removeAttr("disabled");var destinationLength=$(".trip_destination_div").length;$('#rootvectormap').vectorMap('set','hideAllPin',1);initializeAddEditTrip(true);$("#hdnId").val('');$("#create_trip_btn").html("Create Trip");if(create_new_trip_flag){$("#create_new_trip_btn").hide();$("#add_edit_trip").show();$("#mytrip_right").hide();}else{$("#add_edit_trip").hide();$("#mytrip_right").show();$("#create_new_trip_btn").show();}
$("#trip_heading").html("Create New Trip");$("#hdnMode").val("add");$("#hdnId").val("");document.frmAddEditTrip.reset();try{$('#rootvectormap').vectorMap('set','hideAllPin',1);if(previous_dynamic_txt_box!=''){removeTripDynamicTxtBox(previous_dynamic_txt_box);}}catch(err){}
getPotientialDestination('');}
function openBookFlightPanel(){openExplorePanel('mytrip','info');$("#bookTab").trigger('click');}
function openBookCarPanel(){openExplorePanel('mytrip','info');$("#bookTab").trigger('click');}
function updateTripRouteList(id,type){if(document.getElementById("my_trip_wrapper").style.display=="block"){if(type=='origin'){$("#trip_origin_list").html('<img height="25" src="/images/preloader.gif"/>');}
if(type=='destination'){$("#trip_destination_list").html('<img height="25" src="/images/preloader.gif"/>');}
if(type=='potential'){$("#potential_destination_list").html('<img height="25" src="/images/preloader.gif"/>');}
var url;url='/html5/mytrip/triproute/tid/'+id+'/sid/'+Math.random();$.get(url,function(result){response=result.split("|||");if(response[0]!=''){$("#trip_origin_list").html(response[0]);}
if(response[1]!=''){$("#trip_destination_list").html(response[1]);}
if(response[2]!=''){$("#potential_destination_list").html(response[2]);}
if(type!='origin'){$("#explore_more_places").show();}
if(anonymousUser==true){if(response[5]!=0){$("#save_new_trip_btn").show();}else{$("#save_new_trip_btn").hide();}}
if(response[3]!=0){if(response[4]!=''&&type!='potential'){getWeatherForTrip(response[3],'','',7);if(response[6]!=''){$("#weather_city").html(response[6]);}
$("#weather_block").show();}else if(response[4]==''){$("#weather_block").hide();}}else{if(response[3]==0){$("#weather_block").hide();}}
$('#trip_potential_destinations .scrollbar_wrapper').tinyscrollbar({sizethumb:25});});}}
function openExplorePanel(section,widgetName,user){$('#main-top-nav li a').removeClass('active');$('#exploreAnchorID').addClass('active');if((typeof(activeTripPart.cityId)!='undefined')&&(activeTripPart.cityId!=0)){if(section!=''){switch(section){case'mytrip':explorePanelMode='my';isTripSectionMode=false;openPanelFromMyTrip=true;openCityTabsPanel(activeTripPart.cityId,widgetName);break;}}else{return false;}}else{$('.help ').hide();notifyme('Please Select a Destination','error');return false;}}
function myTripList(){var url='/html5/mytrip/list';var params='rand='+parseInt(Math.random()*99999999);mytriplistupdate=$.ajax({type:"GET",url:url,data:params,success:function(data){hideLeftLoader();$("#mytrip_left").html(data);$('#mytrip_left .scrollbar_wrapper').tinyscrollbar({sizethumb:25});}});}
function loadWidgetInfo(weather_city_id,trip_start_date){if(typeof trip_start_date=='undefined'){var trip_start_date=$("#trip_start_date").val();}
var trip_end_date=$("#trip_end_date").val();var weather_day_diff=$("#weatherDayDifference").val();if(weather_city_id!='0'){getWeatherForTrip(weather_city_id,trip_start_date,trip_end_date,weather_day_diff);$("#weather_city_id").val(weather_city_id);$("#weather_city").val(weather_city_id);$("#weather_block").show();}else{$("#weather_block").hide();}}
function scrollbar(){var verticalscroll=$('html, body').animate({scrollTop:200});}
function getMyTripItems(){if(localStorage.getItem('tripItems')){alert(localStorage.getItem('tripItems'));alert(localStorage.getItem('itemLatLng'));}else{return false;}}
function updateMyTrip(anonymousTid,actualTid,tpId){var tripPartId=0;if(typeof tpId!='undefined'){tripPartId=tpId;}
var url='/html5/mytrip/update-my-trip/aId/'+anonymousTid+'/tId/'+actualTid+'/tpId/'+tripPartId+'/sid/'+parseInt(Math.random()*99999999);var params='';$.ajax({type:"GET",url:url,data:params,async:false,success:function(result){var response=jQuery.parseJSON(result);if(response.attempt=='success'){if(response.data.trip_part_id){document.getElementById("tripPartId").value=response.data.trip_part_id;activeTripPart.tripPartId=response.data.trip_part_id;global_trip_part_id=response.data.trip_part_id;}
notifyme(response.message,"success");}else{notifyme(response.message,"error");}}});}
$('#mytrip_dashboard_notes').bind('keypress',function(){$('#notes_disabled').hide();$('#notes_enabled').show();});function dragPotentialDestiantion(ev){ev.dataTransfer.setData("Text",ev.target.id);}
function allowDrop(ev){ev.preventDefault();}
function dropPD(ev,Identifier,Sequence){ev.preventDefault();var oldCityID='';var data=ev.dataTransfer.getData("Text");if(typeof data!='undefined'){cityName=$("#"+data).data('cityname');cityId=$("#"+data).data('cityid');tpId=$("#"+data).data('trippartid');tId=$("#"+data).data('tripid');}
if(Identifier=='addOrigin'){if(insertOriginToTripRoute(document.getElementById(data))!=''){$('#GetDragOrigin').html(insertOriginToTripRoute(document.getElementById(data)));updateTrip('O',cityId,'newO',tId);map.editTripOnMap('',cityId,0,'drag');}else{notifyme('Sorry, Invalid Selection','error');return;}}
else if(Identifier=='replaceOrigin'){oldCityID=$("#trip_origin_list .InlineOrigin").find("label").attr('data-ocityId');updateTrip('O',cityId,'newO',tId);map.editTripOnMap(oldCityID,cityId,0,'drag');updateTripRouteList(tId,'origin');}
else{if(appendDestToTripRoute(document.getElementById(data))!=''){if(Identifier=='addNewDest'){$('#GetDragDestination').before(appendDestToTripRoute(document.getElementById(data)));}else if(Identifier=='OverDest'){$(ev.target).closest('div.InlineDestination').before(appendDestToTripRoute(document.getElementById(data)));}else if(Identifier=='betweenDest'){$(ev.target).closest('div.InlineDestination').after(appendDestToTripRoute(document.getElementById(data)));}
$("#trip_destination_list .InlineDestination").each(function(){var recvSeq=$(this).find("label").attr('data-dsequence');if(recvSeq==Sequence){oldCityID=$(this).find("label").attr('data-dcityid');}
if(typeof(oldCityID)=='undefined'){oldCityID='';}});updateTripSequence('D',cityId,tpId,tId,Sequence);map.editTripOnMap(oldCityID,cityId,Sequence,'drag');}
else{notifyme('Sorry, Invalid Selection','error');return;}}
if($("div.InlineDestination").length==6){$("div.InlineDestination > span.arrowForward:last").hide();}}
function resetSequenceOfDest(){$("div.InlineDestination > div.tripCityName > label > span#label_sequence").each(function(i){var sequence=++i;$(this).html(sequence);$(this).parent().attr('data-DSequence',sequence);});}
function insertOriginToTripRoute(draggedPD)
{var drapPD_ID,newHtml='';var cityName,cityId,trippartId,tripId;if(typeof draggedPD!='undefined'&&draggedPD!=null){drapPD_ID=draggedPD.id;cityName=$('#'+drapPD_ID).data('cityname');cityId=$('#'+drapPD_ID).data('cityid');trippartId=$('#'+drapPD_ID).data('trippartid');tripId=$('#'+drapPD_ID).data('tripid');newHtml='<div class="wrapInlineDestination"> '+'<span class="tripCityName ">'+'<label onclick="loadWidgets('+tripId+', '+trippartId+'), setTripPartContext('+cityId+', \''+cityName+'\', '+trippartId+'),loadWidgetInfo('+cityId+');" id="trip_origin_'+trippartId+' "> '+'<span class="city_label_name" id="origin_label_name">'+draggedPD.innerHTML+'</span> '+'</label>'+'<span onclick="EditInlineCityName(this,'+trippartId+','+tripId+',O,0,'+cityId+');" class="edit_inline_mytrips"></span>'+'<img height="20" width="7" src="/images/left-shadow-small.png"> '+'<span onclick="deleteTripPartRoute('+trippartId+',  '+cityId+', $(this).parent(), 0), loadWidgetInfo('+cityId+');" class="delete_inline_mytrips">'+'<img height="20" width="18" src="/images/html5/icons/del_dest_icon.png"> </span> '+'</span>'+'<br>'+'<a onclick="showDatePickerInline(0);" href="javascript:void(0);" class="icon-with-text">'+'<span class="icon icon-editCal this-icon"></span>'+'<span class="text font_12 semi-light">Leaving: <span id="s_trip_origin_inlineDate">Select date</span></span>'+'<input type="hidden" id="trip_origin_inlineDate" value="">'+'</a>'+'<span style="display:none" class="clearInlinedate marginL2" onclick="clearthisdate(this, 0,'+trippartId+','+tripId+');">'+'<img height="10" width="10" class="curHandPointer" src="/images/html5/cancelInline.png">'+'</span>'+'<div style="display:none" class="clear wrapInlineDatePick" id="divdatepick_ori"><div id="datepick_ori"></div></div>'+'</div>';deleteThisPDfromlist(trippartId);return newHtml;}
else{newHtml='';return newHtml;}}
function appendDestToTripRoute(draggedPD){var n,label_sequence,drapPD_ID,newHtml='';var cityName,cityId,trippartId,tripId;var DcityName,DcityId,DtrippartId,DtripId;n=$('.InlineDestination').length;label_sequence=n+1;if(n==6)
{notifyme('Only 6 Destinations are allowed for a single trip!','error');return;}
else if(n==5)
$('#GetDragDestination').hide();if(typeof draggedPD!='undefined'&&draggedPD!=null){drapPD_ID=draggedPD.id;cityName=$('#'+drapPD_ID).data('cityname');cityId=$('#'+drapPD_ID).data('cityid');trippartId=$('#'+drapPD_ID).data('trippartid');tripId=$('#'+drapPD_ID).data('tripid');newHtml=' <div class="wrapInlineDestination InlineDestination"> '+' <div class="tripCityName" style="display: inline-block;" ondrop="dropPD(event, 2);" ondragover="allowDrop(event)"> '+' <label onclick="loadWidgets('+tripId+', '+trippartId+'), setTripPartContext('+cityId+', \''+cityName+'\', '+trippartId+'), loadWidgetInfo('+cityId+');" id="trip_destination_'+trippartId+'" data-dcityname="'+cityName+'"    data-dcityid="'+cityId+'"    data-dtrippartid="'+trippartId+'"     data-dtripid="'+tripId+'"> '+' <span id="label_sequence">'+label_sequence+'</span> '+' <span class="city_label_name" id="dest_label_name">'+draggedPD.innerHTML+'</span> '+'</label> '+' <span onclick="EditInlineCityName(this, '+trippartId+','+tripId+',D,'+label_sequence+','+cityId+');" class="edit_inline_mytrips"></span> '+' <img width="7" height="20" src="/images/left-shadow-small.png"> '+' <span onclick="deleteTripPartRoute('+trippartId+',  '+cityId+', $(this).parent(), \''+label_sequence+'\');" class="delete_inline_mytrips"><img width="18" height="20" src="/images/html5/icons/del_dest_icon.png"></span> '+' </div> '+' <input type="text" autocomplete="off" size="28" id="trip_origin" value="'+draggedPD.innerHTML+'" class="inputTextCustomize" style="display: none;">';newHtml+=' <span class="arrowForward" ondrop="dropPD(event, 3);" ondragover="allowDrop(event)">Arrow</span>';newHtml+='<br><a href="javascript:void(0);" onclick="showDatePickerInline('+label_sequence+');" class="icon-with-text">'+'<span class="icon icon-editCal this-icon"></span>'+' <span class="text font_12 semi-light">Leaving: <span id="s_trip_destination_inlineDate'+label_sequence+'">Select date</span></span>'+' <input type="hidden" id="trip_destination_inlineDate'+label_sequence+'" value="">'+' </a>'+' <span style="display:none" class="clearInlinedate marginL5" onclick="clearthisdate(this, '+label_sequence+','+trippartId+','+tripId+');">'+'   <img width="10" height="10" src="/images/html5/cancelInline.png" class="curHandPointer">'+' </span>'+' <div style="display:none" class="clear wrapInlineDatePick" id="divdatepick_dest'+label_sequence+'"><div id="datepick_dest'+label_sequence+'"></div></div>'+'</div>';deleteThisPDfromlist(trippartId);return newHtml;}
else{newHtml='';return newHtml;}}
function deleteThisPDfromlist(tripPartId)
{$('#trip_potential_'+tripPartId).parent().remove();if($('#potential_destination_list').find('span.tripCityName').length<1){$('#potential_destination_list').html('<span id="triprouteEmptyPotentialDestination">Add potential destinations by using the map or the Add a City box.<br /> Note: Potential destinations are cities you are considering but aren\'t yet sure of.</span>');}}
function EditInlineCityName(object,tpId,tId,ctType,SeqEdited,oldCityID){if(isEditAlreadyCalled){notifyme("Please edit previous field","error");return;}else{var me=$(object).parent();var labelname=$(object).parent().find('.city_label_name');me.hide();me.after("<input class=\"inputTextCustomize\" type=\"text\" value=\""+labelname.html()+"\" id=\"trip_origin\" size=\"28\" autocomplete=\"off\">");$(".inputTextCustomize").focus().select();isEditAlreadyCalled=true;$(".inputTextCustomize").bind("keyup",function(e){autoComplete(tpId,tId,ctType,SeqEdited,oldCityID);});$(".inputTextCustomize").blur(function(e){var obh=$(this);if(obh.is("input")){obh.prevAll('.tripCityName').show().find('.city_label_name').html(labelname.html());obh.remove();isEditAlreadyCalled=false;}});}}
autoComplete=function(tpId,tId,ctType,SeqEdited,oldCityID){$('.inputTextCustomize').each(function(){var obj=$(this);$(this).autocomplete1({serviceUrl:'/feed/citysuggest/',minChars:2,maxHeight:400,width:200,zIndex:9999,noCache:false,onSelect:function(value,data){var dataPart=data.split('|');updateTrip(ctType,dataPart[3],tpId,tId);map.editTripOnMap(oldCityID,dataPart,SeqEdited,'edit');if(obj.is("input")){obj.prevAll('.tripCityName').show().find('.city_label_name').html(dataPart[0]);obj.hide();isEditAlreadyCalled=false;$('.autocomplete-w1').hide();}}})});}
function showDatePickerInline(caseVal,tpID,tID){var HiddenInputID,spanID,wrapDatePickerID,datePickerID,setMinDate;HiddenInputID=spanID=wrapDatePickerID=datePickerID='';switch(caseVal){case 0:HiddenInputID='trip_origin_inlineDate';getDateCounter=0;spanID='s_trip_origin_inlineDate';wrapDatePickerID='divdatepick_ori';datePickerID='datepick_ori';break;case 1:HiddenInputID='trip_destination_inlineDate1';getDateCounter=1;spanID='s_trip_destination_inlineDate1';wrapDatePickerID='divdatepick_dest1';datePickerID='datepick_dest1';break;case 2:HiddenInputID='trip_destination_inlineDate2';getDateCounter=2;spanID='s_trip_destination_inlineDate2';wrapDatePickerID='divdatepick_dest2';datePickerID='datepick_dest2';break;case 3:HiddenInputID='trip_destination_inlineDate3';getDateCounter=3;spanID='s_trip_destination_inlineDate3';wrapDatePickerID='divdatepick_dest3';datePickerID='datepick_dest3';break;case 4:HiddenInputID='trip_destination_inlineDate4';getDateCounter=4;spanID='s_trip_destination_inlineDate4';wrapDatePickerID='divdatepick_dest4';datePickerID='datepick_dest4';break;case 5:HiddenInputID='trip_destination_inlineDate5';getDateCounter=5;spanID='s_trip_destination_inlineDate5';wrapDatePickerID='divdatepick_dest5';datePickerID='datepick_dest5';break;case 6:HiddenInputID='trip_destination_inlineDate6';getDateCounter=6;spanID='s_trip_destination_inlineDate6';wrapDatePickerID='divdatepick_dest6';datePickerID='datepick_dest6';break;}
$(".wrapInlineDatePick").hide();$("#"+wrapDatePickerID).show();$("#"+datePickerID).datepicker({inline:true,minDate:0,yearRange:'2012:2020',dateFormat:'mm-dd-yy',defaultDate:0,onSelect:function(dateText,inst){$("#"+wrapDatePickerID).hide();getStatusCal=dateText;populateDatesInlineArray();var cdate=MMDDYYtoYYMMDD(getStatusCal);var flag=areDatesInAscOrder(DatesInlineArray,cdate);if(flag){document.getElementById(HiddenInputID).value=MMDDYYtoYYMMDD(getStatusCal);$("#"+spanID).html(formatter(getStatusCal,1));$("#"+wrapDatePickerID).parent().find('.clearInlinedate').each(function(){$(this).remove();});var myDateCancelHtml='<span onclick="clearthisdate(this, '+caseVal+','+tpID+','+tID+');" class="clearInlinedate marginL2">'+'<img width="10" height="10" src="/images/html5/cancelInline.png" class="curHandPointer">'+'</span>';$("#"+wrapDatePickerID).parent().append(myDateCancelHtml);var date=$("#"+HiddenInputID).val();updateTrip('date',getStatusCal,tpID,tID);setStartEndDatesforTrip();}else{notifyme("Please enter correct leaving date for destinations!","error");}}});}
function cleanArray(actual){var newArray=new Array();for(var i=0;i<actual.length;i++){if(actual[i]){newArray.push(actual[i]);}}
return newArray;}
function clearthisdate(thisObj,thisObjIndex,tpID,tID){var HiddenInputID,spanID;switch(thisObjIndex){case 0:HiddenInputID='trip_origin_inlineDate';spanID='s_trip_origin_inlineDate';break;case 1:HiddenInputID='trip_destination_inlineDate1';spanID='s_trip_destination_inlineDate1';break;case 2:HiddenInputID='trip_destination_inlineDate2';spanID='s_trip_destination_inlineDate2';break;case 3:HiddenInputID='trip_destination_inlineDate3';spanID='s_trip_destination_inlineDate3';break;case 4:HiddenInputID='trip_destination_inlineDate4';spanID='s_trip_destination_inlineDate4';break;case 5:HiddenInputID='trip_destination_inlineDate5';spanID='s_trip_destination_inlineDate5';break;case 6:HiddenInputID='trip_destination_inlineDate6';spanID='s_trip_destination_inlineDate6';break;}
$("#"+spanID).html('Select date');$("#"+HiddenInputID).value='';var date=$("#"+HiddenInputID).val();updateTrip('date','00-00-0000',tpID,tID);$(thisObj).hide();DatesInlineArray[thisObjIndex]='';setStartEndDatesforTrip();getStatusCal='';}
function setStartEndDatesforTrip(){var DatesInlineArrayNew=[];DatesInlineArrayNew=cleanArray(DatesInlineArray);var howManyDatesSetCount=DatesInlineArrayNew.length;if(howManyDatesSetCount==0){$(".myTripDate").html("");}
else if(howManyDatesSetCount==1){$(".myTripDate").html("From: "+formatter(YYMMDDtoMMDDYY(DatesInlineArrayNew[0])));}
else if(howManyDatesSetCount>1){$(".myTripDate").html("From: "+formatter(YYMMDDtoMMDDYY(DatesInlineArrayNew[0]))+" to "+formatter(YYMMDDtoMMDDYY(DatesInlineArrayNew[DatesInlineArrayNew.length-1])));}}
function areDatesInAscOrder(timeSeries,cdate){if(timeSeries.length<2){return true;}
var flag1=0;for(var i=0;i<getDateCounter;i++){if(timeSeries[i]!=''&&typeof timeSeries[i]!='undefined'){if(validationDate(timeSeries[i],cdate,'trip')==0){flag1=1;break;}}}
if(flag1==0){for(var j=getDateCounter+1;j<timeSeries.length;j++){if(timeSeries[j]!=''&&typeof timeSeries[j]!='undefined'){if(validationDate(cdate,timeSeries[j],'trip')==0){flag1=1;break;}}}}
if(flag1==1){return false;}
return true;}
function formatter(passedDate,mShort){if(typeof passedDate!='undefined'){var splitDate=passedDate.split('-');var year=splitDate[2];var day=splitDate[1];var month=splitDate[0].replace(/\b0+/g,"");if(mShort==1){var shortMonthsNames=new Array("Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec");fpassedDate=shortMonthsNames[parseInt(month)-1]+' '+day+', '+year;}
else{var MonthsNames=new Array("January","February","March","April","May","June","July","August","September","October","November","December");fpassedDate=MonthsNames[parseInt(month)-1]+' '+day+', '+year;}
return fpassedDate;}}
function MMDDYYtoYYMMDD(passedDate){if(typeof passedDate!='undefined'){var splitDate=passedDate.split('-');var year=splitDate[2];var day=splitDate[1];var month=splitDate[0];var fpassedDate=year+'-'+month+'-'+day;return fpassedDate;}}
function YYMMDDtoMMDDYY(passedDate){if(typeof passedDate!='undefined'){var splitDate=passedDate.split('-');var year=splitDate[0];var day=splitDate[2];var month=splitDate[1];var fpassedDate=month+'-'+day+'-'+year;return fpassedDate;}}
function updateTrip(param,val,tpId,tId){var url='html5/mytrip/update-trip/';var tripId=tId;var params=''
var newDestination=0;var newOrigin=0;if(typeof tId=='undefined'){tripId=$("#tripPlaceId").val();}
if((param=='title')&&(val!='')){url+='tId/'+tripId+'/title/'+val;}
if((param=='travellers')&&(val!='')){url+='tId/'+tripId+'/travellers/'+val;}
if((param=='O'||param=='D')&&(typeof val!='undefined')&&(typeof tpId!='undefined')&&(tpId!=''||tpId!='0')){if(tpId=='newD'){newDestination=1;url+='tId/'+tripId+'/cId/'+val+'/cityType/'+param+'/destination/'+newDestination;}else if(tpId=='newO'){tpId=0;newOrigin=1;url+='tId/'+tripId+'/cId/'+val+'/cityType/'+param+'/origin/'+newOrigin;}else{url+='tId/'+tripId+'/tpId/'+tpId+'/cId/'+val+'/cityType/'+param;}}
if((param=='date')&&(typeof val!='undefined')&&(typeof tpId!='undefined')&&(tpId!=''||tpId!='0')){url+='tId/'+tripId+'/tpId/'+tpId+'/from/'+val;}
$.ajax({type:"GET",url:url,data:params,success:function(result){var response=jQuery.parseJSON(result);if(response!='null'){if(response.attempt=='success'){notifyme(response.message,"success");if((response.update==param)&&(response.update=='title')){myTripList();}else if((response.update==param)&&(response.update=='O'||response.update=='D')){updateTripRouteList(tripId,'origin');}}else{if((response.update==param)&&(response.update=='O'||response.update=='D')){notifyme(response.message,"error");updateTripRouteList(tripId,'destination');}else{notifyme(response.message,"error");}}}}});}
function updateTripSequence(param,val,tpId,tId,sequence){var url='html5/mytrip/update-trip/';var tripId=tId;var params=''
if(typeof tId=='undefined'){tripId=$("#tripPlaceId").val();}
if((param=='title')&&(val!='')){url+='tId/'+tripId+'/title/'+val;}
if((param=='O'||param=='D')&&(typeof val!='undefined')&&(typeof tpId!='undefined')&&(tpId!=''||tpId!='0')){url+='tId/'+tripId+'/tpId/'+tpId+'/cId/'+val+'/cityType/'+param;}
if((param=='date')&&(typeof val!='undefined')&&(typeof tpId!='undefined')&&(tpId!=''||tpId!='0')){url+='tId/'+tripId+'/tpId/'+tpId+'/cId/'+val+'/date/'+val;}
if(typeof sequence!='undefined'){url+='/seq/'+sequence;}
$.ajax({type:"GET",url:url,data:params,success:function(result){var response=jQuery.parseJSON(result);if(response!='null'){if(response.attempt=='success'){notifyme(response.message,"success");if((response.update==param)&&(response.update=='title')){myTripList();}else if((response.update==param)&&(response.update=='O'||response.update=='D')){updateTripRouteList(tripId,'origin');}}else{if((response.update==param)&&(response.update=='O'||response.update=='D')){notifyme(response.message,"error");updateTripRouteList(tripId,'destination');}}}}});}
function toggleMeTextBox(object,mode){var value;var me=$(object).parent();me.hide();me.after("<input class=\"inputTextCustomize\" style=\"margin-bottom:29px;\" type=\"text\" value=\"Enter the city\" size=\"28\" autocomplete=\"off\">");$(".inputTextCustomize").focus().select();$(".inputTextCustomize").bind("keyup",function(e){if(mode=='O'){autoCompleteNewDestination('O');}
else if(mode=='D'){autoCompleteNewDestination('D');}});$(".inputTextCustomize").blur(function(){value=$(this).val();$(this).remove();if(me.is("input")){me.val(value);}else if(me.is("span")){me.html(value);}
me.show();});}
autoCompleteNewDestination=function(mode){$('.inputTextCustomize').each(function(){var obj=$(this);$(this).autocomplete1({serviceUrl:'/feed/citysuggest/',minChars:2,maxHeight:400,width:200,zIndex:9999,noCache:false,onSelect:function(value,data){var dataPart=data.split('|');if(obj.is("input")){tripId=$("#tripPlaceId").val();if(mode=='D'){var count=parseInt($('#trip_destination_list .InlineDestination').length);updateTrip('D',dataPart[3],'newD',tripId);updateTripRouteList(tripId,'destination');map.editTripOnMap('',dataPart,count+1,'edit');}
else if(mode=='O'){updateTrip('O',dataPart[3],'newO',tripId);updateTripRouteList(tripId,'origin');map.editTripOnMap('',dataPart,0,'edit');}
$('.autocomplete-w1').hide();obj.hide();}}})});}
function EditInlineMTTitle(object){var me=$(object);var value;var pattern=/^[A-Za-z0-9 ]+$/;me.hide();me.closest('#saveCancelTitleWrap').remove();me.parent().find('.editInline').hide();me.parent().find('span.curHandPointer').hide();me.after("<input class=\"inputTextEditInTitle inputTextCustomize\" size=\"30\" id=\"trip_title\" name=\"trip_title\" maxlength=\"50\" type=\"text\" value=\""+$(object).html()+"\" />\n\
                <div style=\"margin-top:7px\"  class=\"inline-block\" id=\"saveCancelTitleWrap\"><img src=\"/images/html5/SaveInline.png\" height=\"12\" width=\"12\" id=\"saveTripTitle\" class=\"curHandPointer\"/> <img class=\"curHandPointer\" id=\"cancelTripTitle\" src=\"/images/html5/cancelInline.png\" height=\"12\" width=\"12\"/></div>");$('.inputTextEditInTitle').focus().select();$("#trip_title").bind("keyup",function(e){e.preventDefault();if(e.keyCode=='13'){EdittheTitle($(object));}});$("#saveTripTitle").click(function(){EdittheTitle($(object));});$("#cancelTripTitle").click(function(){$('#trip_title').remove();$('#saveCancelTitleWrap').remove();if(me.is("input")){if(pattern.test(value)){me.val(value);}else{notifyme('Invalid Trip Name!','error');}}
else if(me.is("span")){if(pattern.test(value)){me.html(value);}
else{notifyme('Invalid Trip Name!','error');}}
me.show();$('#trip_title').remove();me.parent().find('span.curHandPointer').show();});}
function EdittheTitle(object){var value=$('#trip_title').val();var pattern=/^[A-Za-z0-9 ]+$/;$('#trip_title').remove();$('#saveCancelTitleWrap').remove();if($(object).is("input")){if(pattern.test(value)){$(object).val(value);updateTrip('title',value);}
else{notifyme('Invalid Trip Name!','error');}}
else if($(object).is("span")){if(pattern.test(value)){$(object).html(value);updateTrip('title',value);}
else{notifyme('Invalid Trip Name!','error');}}
$(object).show();$('#trip_title').remove();$(object).parent().find('span.curHandPointer').show();}
function GetNumrOfTrav(){var TravValue=prompt('Please Enter Number of Travelers','2');if(TravValue>0&&TravValue<=99&&TravValue!=null&&TravValue!=undefined){updateTrip('travellers',TravValue);$("#NoTravAdded").text(TravValue).addClass('font_16 strong bg_gray rounded');$("#NoTravAdded").parent().find('img.curHandPointer').hide();}
else{notifyme('Minimum 1 and Maximum 99 travelers are allowed for a single trip!','error');}}
function EditInlineNumOfTrav(object,tId){var me=$(object);var value;var trav;me.hide();me.parent().find('span.curHandPointer').hide();me.after("<input class=\"inputTextEditInTrav\" style=\"width:30px\" size=\"30\" id=\"trip_trav\" name=\"trip_trav\" maxlength=\"50\" type=\"text\" value=\""+$(object).html()+"\" />");$('.inputTextEditInTrav').focus().select().ForceNumericOnly();$("#trip_trav").bind("keyup",function(e){e.preventDefault();if(e.keyCode=='13'){value=$(this).val();if(value>0&&value<=99&&typeof value!=undefined&&typeof value!=null)
{$(this).remove();if(me.is("span")){trav=value;me.html(value);updateTrip('travellers',value);}
me.show();me.parent().find('span.curHandPointer').show();}
else notifyme('Minimum 1 and Maximum 99 travelers are allowed for a single trip!','error');}});$("#trip_trav").blur(function(){$(this).remove();if(me.is("span")){me.html(trav);}
me.show();me.parent().find('span.curHandPointer').show();});}
jQuery.fn.ForceNumericOnly=function()
{return this.each(function()
{$(this).keydown(function(e)
{var key=e.charCode||e.keyCode||0;return(key==8||key==9||key==46||(key>=37&&key<=40)||(key>=48&&key<=57)||(key>=96&&key<=105));});});};function populateDatesInlineArray(){DatesInlineArray=[];DatesInlineArray=[$("#trip_origin_inlineDate").val(),$("#trip_destination_inlineDate1").val(),$("#trip_destination_inlineDate2").val(),$("#trip_destination_inlineDate3").val(),$("#trip_destination_inlineDate4").val(),$("#trip_destination_inlineDate5").val(),$("#trip_destination_inlineDate6").val()];};var friendTripFlag=false;var friendtriplistupdate=null;var activeFriendTripPart={};var friendwidgetShow=true;var setTrippart='';var friendDashboardWidget=true;function setFriendTripPartContext(cityId,cityName,tripPartId){if(typeof tripPartId=="undefined"){tripPartId=document.getElementById("tripPartId").value;}
activeFriendTripPart={'cityId':cityId,'cityName':cityName,'tripPartId':tripPartId};document.getElementById("tripPartId").value=tripPartId;currentCityObject={'id':cityId,'n':cityName};}
function openFriendTrips(){if(docBottom==true||panelPositionY==true||dockPosition==true){restorPanel();}
friendTripFlag=true;$("#goback").html('&laquo; Go back to Friends Trips');myTripFlag=false;resetView();$("#OutrContainer").hide();$(".welcomeBox").hide();$("#geoInformation").hide();$("#PlanBookComponent").hide();$("#topNav li").removeClass("active");$("#mytripslitab").removeClass("active");$("#friendstripslitab").addClass("active");$("#topNavItems").hide();$("#my_trip_wrapper").hide();$("#friend_trip_wrapper").show();friendTripInit();}
function friendTripInit(){friendwidgetShow=true;if(friendTripXhr!=null){friendTripXhr.abort();friendTripXhr=null;}
var url='/html5/friendtrip/list/rand/'+parseInt(Math.random()*99999999);friendTripXhr=$.get(url,function(data){hideFriendLeftLoader();$("#friendtrip_left").html(data);$('#friendtrip_left .scrollbar_wrapper').tinyscrollbar({sizethumb:25});$("#friend_trip_list li").removeClass('active');if(friend_global_trip_id!=''){$("#friendTrip_"+friend_global_trip_id).addClass('active');loadFriendTripInfo(friend_global_trip_id);}else{loadFriendTripInfo();$("#friendtrip_left  ul:first > li:first-child").addClass("active");}});}
function friendTripDetailView(itemId,tripId,activeU,tab){friendwidgetShow=false;$("#friend_widget_wrapper").hide();$("#friend_details_wrapper").show();$("#item_list_nav_pan").show();$("#friend_fr_wrapper").hide();fillFriendItemDetail(itemId,activeU,tab);fillFriendTripItems(0,tripId,function(){$("#friend_item_list_wrapper ul li").removeClass('active');$("#friend_item_list_wrapper ul li#friendstripli_"+itemId).addClass('active');});}
function fillFriendTripItems(categoryId,tripId,custfFunc){if(friendDashboardWidget){if(typeof custfFunc=='undefined'){$("#friend_item_detail_wrapper").html(preloadDiv);if(setTrippart==true){tripPartId=document.getElementById("tripPartId").value;var url='/html5/friendtrip/itemlist/c/'+categoryId+'/t/'+tripId+'/ol/1/tp/'+tripPartId;}else{var url='/html5/friendtrip/itemlist/c/'+categoryId+'/t/'+tripId+'/ol/1';}}else{if(setTrippart==true){tripPartId=document.getElementById("tripPartId").value;var url='/html5/friendtrip/itemlist/c/'+categoryId+'/t/'+tripId+'/tp/'+tripPartId;}else{var url='/html5/friendtrip/itemlist/c/'+categoryId+'/t/'+tripId;}}}else{var url='/html5/friendtrip/friendrecommendlist/c/'+categoryId+'/t/'+tripId;}
$("#friend_item_list_wrapper").html('<div style="padding:80px 0;" align="center">Loading..<br /><img src="/images/preloader.gif"/></div>');$.ajax({'url':url,'success':function(data){$("#friend_item_list_wrapper").html(data);$('#friend_item_list_wrapper .scrollbar_wrapper').delay(500).tinyscrollbar({sizethumb:25});if(typeof custfFunc=='function'){custfFunc();}}});if(custfFunc){return custfFunc();}}
function fillFriendItemDetail(itemId,activeUser,mode){if(mode=='FR'){var url='/html5/friendtrip/poi/i/'+itemId+'/u/'+activeUser+'/mode/'+mode+'/tripId/'+friend_global_trip_id;}else{var url='/html5/friendtrip/poi/i/'+itemId+'/u/'+activeUser;}
$("#friend_item_detail_wrapper").html(preloadDiv);$.get(url,function(data){$("#friend_item_detail_wrapper").html(data);$('#friend_item_detail_wrapper .scrollbar_wrapper').delay(500).tinyscrollbar({sizethumb:25});});if($.isFunction($(".scrollable").scrollable()))
$(".scrollable").scrollable().navigator();$("#friend_item_list_wrapper ul li").removeClass('active');$("#friend_item_list_wrapper ul li#friendstripli_"+itemId).addClass('active');}
function gotoFriendDashboard(){tripPartId=document.getElementById("tripPartId").value;if(friendDashboardWidget){loadFriendWidgets(friend_global_trip_id);friendwidgetShow=true;$("#friend_details_wrapper").hide();$("#friend_widget_wrapper").show();$('#friend_widget_wrapper .scrollbar_wrapper').tinyscrollbar({sizethumb:25});$("#item_list_nav_pan").show();}else{friendTripPanelOnOff('friend',friend_global_trip_id);}}
function hideFriendRightLoader(){$("#friendtripsrightloader").hide();}
var loadFriendTripFlag=false;function loadFriendTripInfo(tripId){friendwidgetShow=true;setTrippart=false;friend_global_trip_id=tripId;weatherForMytrip='fn';$("#friend_trip_list li").removeClass('active');if((typeof tripId!='undefined')&&(tripId!='')){$("#friendTrip_"+tripId).addClass('active');}else{$("#friendtrip_left ul:first > li:first-child").addClass("active");}
var detailUrl='/html5/friendtrip/details/';if(!isNaN(tripId))
detailUrl+='t/'+tripId;if(isuserfriend){if(isuserfriend=='yes'){detailUrl+='/f/'+isuserfriend;}else{detailUrl+='f/'+isuserfriend;}}
loadingImagesForFriendsWidget();$("#friendtrip_right").html('<div style="padding:120px 0 150px 0;" align="center">Loading...<br /><img src="/images/panel-loader.gif" alt="Loading..."/></div>');$.ajax({type:"GET",url:detailUrl,success:function(data){if(data=='0'){var errorMsg='<div style="padding-top:90px;"><center><h2 style=" color:rgba(32,87,145,.9);">No Friend\'s Trip Found</h2></center><br /></div>';$("#recommended_places").hide();$("#friend_contents_wrapper").html(errorMsg);}else{$("#friendtrip_right").html(data);if(typeof(tripId)=='undefined'){tripId=friend_global_trip_id;}
if(tripId!=undefined){showTripPushPin(tripId,'friend');}
$('#friendtrip_right .scrollbar_wrapper').delay(500).tinyscrollbar({sizethumb:25});}
var trip_start_date=$("#friend_trip_start_date").val();var trip_end_date=$("#friend_trip_end_date").val();var weather_city_id=$("#friend_weather_city_id").val();if(weather_city_id!='0'){getWeatherForFriendTrip(weather_city_id,trip_start_date,trip_end_date);$("#friend_weather_block").show();}else{$("#friend_weather_block").hide();}}});}
function loadFriendWidgets(tripId,tripPartId,panel){$(".tripCityName").removeClass('myselect');$("#trip_potential_"+tripPartId).parent().addClass('myselect');$("#trip_origin_"+tripPartId).parent().addClass('myselect');$("#trip_destination_"+tripPartId).parent().addClass('myselect');if(friendDashboardWidget==true||panel=='friend'){if(typeof tripPartId!='undefined'){setTrippart=true;document.getElementById("tripPartId").value=tripPartId;}
if(friendwidgetShow==false){fillFriendTripItems(0,tripId);}
var detailUrl='/html5/friendtrip/details/ow/1/t/'+tripId+'/tp/'+tripPartId;loadingImagesForFriendsWidget();$.get(detailUrl,function(data){$("#friend_widget_wrapper").html(data);$('#friend_widget_wrapper .scrollbar_wrapper').tinyscrollbar({sizethumb:25});$("img.lazyloading").lazyload({placeholder:"/images/html5/img-lazy-loading.gif",effect:"fadeIn",threshold:400});loadFriends(tripId,tripPartId);});if(panel=='friend'){friendDashboardWidget=false;}}else{friendTripPanelOnOff('friend',tripId,tripPartId);}}
function loadingImagesForFriendsWidget(){$("#friend_hotel_flight_widget").html('<center><img style="padding-top:70px;" src="/images/preloader.gif"  /></center>');$("#friend_hostel_car_widget").html('<center><img style="padding-top:70px;" src="/images/preloader.gif" /></center></span>');$("#friend_attraction_activity_widget").html('<center><img style="padding-top:70px;" src="/images/preloader.gif"  /></center>');$("#friend_restaurant_nightlife_widget").html('<center><img style="padding-top:70px;" src="/images/preloader.gif"  /></center>');$("#friend_events_deals_widget").html('<center><img style="padding-top:70px;" src="/images/preloader.gif"  /></center>');$("#friend_shopping_widget").html('<center><img style="padding-top:70px;" src="/images/preloader.gif"  /></center>');$(".empty_widget").html('<center><img src="/images/preloader.gif"  /></center>');}
function setFriendsTripInnerNavigation(panel){switch(panel){case'my':$("#fa_trip_destination").addClass('active');$("#fa_friends_recommendations").removeClass('active');$("#fa_friends_comments").removeClass('active');break;case'friend':$("#fa_friends_recommendations").addClass('active');$("#fa_trip_destination").removeClass('active');$("#fa_friends_comments").removeClass('active');break;case'comment':$("#fa_friends_comments").addClass('active');$("#fa_trip_destination").removeClass('active');$("#fa_friends_recommendations").removeClass('active');break;}}
function friendTripNavigation(param){switch(param){case'current':$('#friendcurrentul').show();$('#friendupcomingul').hide();$('#friendpastul').hide();$("#friend_trip_list li").removeClass('active');break;case'upcoming':$('#friendupcomingul').show();$('#friendcurrentul').hide();$('#friendpastul').hide();$("#friend_trip_list li").removeClass('active');break;case'past':$('#friendpastul').show();$('#friendupcomingul').hide();$('#friendcurrentul').hide();$("#friend_trip_list li").removeClass('active');break;case'all':FriendTripList();break;}
$('#friendtrip_left .scrollbar_wrapper').tinyscrollbar({sizethumb:25});$('#friendsTrip_dropdown_ul').hide();setFTFirstTripSelected(param);}
function setFTFirstTripSelected(param){var msgHtml='<div style="padding-top:190px;padding-right:190px" id=""><center><h6 style="color: rgba(32, 87, 145, 0.9); font-size: 18px;">No '+param+' trip found.</h6></center><br></div>';switch(param){case'current':var tempElement=$("#friendcurrentul ul li:first-child");var childCount=$('#friendcurrentul ul > li').length;break;case'upcoming':var tempElement=$("#friendupcomingul ul li:first-child");var childCount=$('#friendupcomingul ul > li').length;break;case'past':var tempElement=$("#friendpastul ul li:first-child");var childCount=$('#friendpastul ul > li').length;break;case'all':var tempElement=$("#friendcurrentul ul li:first-child");var childCount=$('#friendcurrentul ul > li').length;break;}
if(typeof tempElement!='undefined'&&childCount>0){$('a',$(tempElement)).trigger('click');}
if(typeof tempElement=='undefined'||childCount<1){$("#friendtrip_right").html(msgHtml);}}
function FriendTripList(){var url='/html5/friendtrip/list';var params='rand='+parseInt(Math.random()*99999999);friendtriplistupdate=$.ajax({type:"GET",url:url,data:params,success:function(data){hideFriendLeftLoader();$("#friendtrip_left").html(data);var childCount=$('#friendcurrentul ul > li').length;if(childCount>0){$("#friendcurrentul ul li:first-child").addClass("active");}}});}
function loadFriendWidgetInfo(weather_city_id){var trip_start_date=$("#friend_trip_start_date").val();var trip_end_date=$("#friend_trip_end_date").val();var weather_day_diff=$("#weatherDayDifferenceF").val();$("#friend_weather_city").val(weather_city_id);if(weather_city_id!='0'){getWeatherForFriendTrip(weather_city_id,trip_start_date,trip_end_date,weather_day_diff);$("#friend_weather_city").val(weather_city_id);$("#friend_weather_block").show();}else{$("#friend_weather_block").hide();}}
function getWeatherForFriendTrip(city,startDate,endDate,weather_day_diff){if(weather_day_diff<7){endDate='';}
$("#friend_trip_weather").html('<div style="padding:top:15px;" align="center">Loading..<br /> <img src="/images/preloader.gif" alt=""/></div>');if(city){var url='/html5/plan/getweatherfortrip/city/'+city+'/startDate/'+startDate+'/endDate//tripId/'+friend_global_trip_id+'/ttype/'+weatherForMytrip+'/rand/'+parseInt(Math.random()*99999999);$.get(url,function(data){$("#friend_trip_weather").html(data);exchangeWeatherInformation(weatherForMytrip);});}else{$("#friend_trip_weather").html('');}}
function friendTripPanelOnOff(activePanel,tripId,tripPartId){setTripInnerNavigation(activePanel);if(activePanel=='friend'){$("#fa_trip_destination").removeClass("active");$("#fa_friends_recommendations").addClass("active");$("#friend_widget_wrapper").hide();$("#friend_details_wrapper").hide();$("#friend_fr_wrapper").show();$(".point_tab_downb").show();$(".point_tab_down").hide();friendDashboardWidget=false;if(typeof tripPartId!="undefined"){var url='/html5/friendtrip/recommendeditemlist/t/'+tripId+'/tp/'+tripPartId;}else{var url='/html5/friendtrip/recommendeditemlist/t/'+tripId;}
$("#friend_fr_wrapper").html(preloadDiv);$.get(url,function(data){$("#friend_fr_wrapper").html(data);if(document.getElementById("gCtr_Val").value){var gCtr=document.getElementById("gCtr_Val").value;for(i=1;i<=gCtr;i++){$('.fRecoG'+i).equalizeHeights();}}});}else{$("#fa_friends_recommendations").removeClass("active");$("#fa_trip_destination").addClass("active");$("#friend_widget_wrapper").show();$("#friend_details_wrapper").hide();$("#friend_fr_wrapper").hide();$(".point_tab_downb").hide();$(".point_tab_down").show();friendDashboardWidget=true;}}
function recommendFromFriendTrip(itemId,tripId,panel){url='/mytrip/recommendfromfriendtrip/tripItem/'+itemId+'/rand/'+parseInt(Math.random()*99999999);$.getJSON(url,function(result){if(result.attempt=='success'){notifyme("Item recommended successfully to your friend's trip","success");if(typeof panel!='undefined'&&panel=='details'){$('#friend_FRdetail_'+itemId).addClass('highlight');document.getElementById('friend_FRdetail_'+itemId).innerHTML='Recommended by friends and you';}else{$('#friend_FR_'+itemId).addClass('ft_highlight');document.getElementById('friend_FR_'+itemId).innerHTML='Recommended by friends and you';}}else{notifyme(result.message,"error");}});};var isFriendSelected;function sharePanelInit(){isSharePanel=true;var url='/html5/share/index';$("#Share").html('<div style="padding:50px 0 250px 0;" align="center">Loading..<br /><img src="/images/panel-loader.gif" alt=""/></div>');if(!isNaN(global_trip_id)){url+='/t/'+global_trip_id;}
$.get(url,function(data){$("#Share").html(data);fillShareFriends('');});}
function sharePost(tripId,name,caption,message,description,picture,link,tripName,userName,twitterPostLink){if(document.getElementById('fbpost').checked){$.post("/fbapi/wallpost",{name:name,caption:caption,message:message,description:description,picture:picture,link:link},function(data){if(data.attempt=='success'){notifyme("Message posted on facebook successfully!","success");var url='/html5/share/updatetrip/t/'+tripId+'/fid/'+data.data.id;$.get(url,function(data){});}});}
if(document.getElementById('twpost').checked){window.open('https://twitter.com/intent/tweet?text='+twitterPostLink,'tweet_win','width=699,height=600');}}
function sharesubmitenter(elm,e,widget){var keycode;if(window.event)keycode=window.event.keyCode;else if(e)keycode=e.which;else return true;if(keycode==13){fillShareFriends(elm.value);}
else
return true;}
function fillShareFriends(fsearch){$("#FriendFromShareP").hide();var friendList='';$("#shareff").html('<div style="height:50px;padding-top:50px;" align="center">Loading..<br /> <img src="/images/preloader.gif" alt=""/></div>');FB.api('/me/friends',{fields:'id, picture, first_name, last_name, name'},function(response){if(typeof response.data!='undefined'&&response.data.length>0&&response.data!=null){$.each(response.data,function(i,friend){if(typeof fsearch!='undefined'&&fsearch!=''){if(friend.first_name.toLowerCase()==fsearch.toLowerCase()||friend.last_name.toLowerCase()==fsearch.toLowerCase()||friend.name.toLowerCase()==fsearch.toLowerCase()){friendList+='<a href="javascript://" class="thumb" onclick="sharePanelGetFriends(\''+friend.id+'\',\''+friend.first_name+'\',this)">';friendList+='<label><img src="'+friend.picture.data.url+'" /><center>'+friend.first_name+'</center></label></a>';}}else{$("#searchFromShareP").val('');friendList+='<a href="javascript://" class="thumb" onclick="sharePanelGetFriends(\''+friend.id+'\',\''+friend.first_name+'\',this)">';friendList+='<label><img src="'+friend.picture.data.url+'" /><center>'+friend.first_name+'</center></label></a>';}});$("#shareff").html(friendList);if($("#shareff").height()<150){$("#share_topcontainer .ff .overview").css("position","static");}else{$("#share_topcontainer .ff .overview").css("position","absolute");}
$('#ask_frndsdiv .scrollbar_wrapper').tinyscrollbar({sizethumb:25});}else{friendList+='<article class="padding align-center font_18" style="padding-top:55px; color:rgba(32,87,145,.9);">No Friend\'s Found!</article>';$("#shareff").html(friendList);$('#ask_frndsdiv .scrollbar_wrapper').tinyscrollbar({sizethumb:25});}});}
function dateFormat(dateString){var monthNames=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];try{var part=dateString.split(' ');var datePart=part[0].split('-');var timePart=part[1].split(':');return datePart[2]+' '+monthNames[datePart[1]-1]+', '+datePart[0]+' | '+timePart[0]+':'+timePart[1];}
catch(Exception){return'';}}
function fsharesubmit(postlink){if(postlink!=''){var tripUrl=postlink;}else{var tripUrl='';}
var params=$("#finvite").serialize()+"&tripUrl="+tripUrl;$.ajax({type:"POST",url:"/html5/share/fshare/",data:params,success:function(json,status){if(json.attempt=='success'){notifyme("Trip has been shared with your friend!","success");}else{notifyme('Please select any friend or enter friend email address!',"error");}},error:function(jqXHR,textStatus,errorThrown){notifyme(errorThrown,"error");}});}
function postOnWallFromShare(caption,description,picture,postLink){var id=$("#FrienIdSelectedShareP").val();if(id==''){notifyme("Please select a friend",'error');return false;}
var obj={method:'feed',display:'popup',link:postLink,to:id,picture:picture,name:'Georama',caption:caption,description:description};function callback(response){if(typeof response!='undefined'){if(typeof tripId!='undefined'){var url='/html5/share/updatetrip/t/'+tripId+'/fid/'+response.post_id;$.get(url,function(data){});}}}
FB.ui(obj,callback);}
function sendMessageFromShare(){var id=$("#FrienIdSelectedShareP").val();sendToFriend1(id);}
function sharePanelGetFriends(uid,name,object){if(isFriendSelected!=uid){$(".ff a.thumb").removeClass('selected');$(object).addClass('selected');$("#FrienIdSelectedShareP").val(uid);$("#FriendFromShareP").html('You have selected: <b>'+name+'</b>').show();}
else{if($(object).hasClass('selected')){$(object).removeClass('selected');$("#FrienIdSelectedShareP").val('');$("#FriendFromShareP").html('').show();}
else{$(".ff a.thumb").removeClass('selected');$(object).addClass('selected');$("#FrienIdSelectedShareP").val(uid);$("#FriendFromShareP").html('You have selected: <b>'+name+'</b>').show();}}
isFriendSelected=uid;};var hostelCacheData;var hostelBingData;var hostelFlag=false;var hostelMinRating=0;var hostelMaxRating=100;var sortBy='';var desc;var sortOrder=0;var sortByRatingFlag=false;var hoselStarFlag=true;var hoselPriceFlag=true;var hoselBookingStarFlag=true;var Hostelplanrating_sort_order='0';var Hostelplanprice_sort_order='0';var hostelArrayIndex='';var objMap=null;function sortByRating(tab,minRange,maxRange){hostelMinRating=minRange;hostelMaxRating=maxRange;renderHostels(hostelCacheData);}
var hostellist="";function openhostelDetailPlan(id,arrayIndex,calledFrom){btnFlag=true;hostelArrayIndex=arrayIndex;$("#plan-hostelSorting").hide();$("#plan_hostel_id").val(id);var sourceIds=$("#tripItemSourceIds").val();var sourceIdArray=sourceIds.split(',');var addToTripText=explorePanelMode=='friend'?'Recommend':'Add to Trip';var removeFromTripText=explorePanelMode=='friend'?'Recommended':'Remove';var addToTripFlag=explorePanelMode=='friend'?'friend':'grid';cacheDetailEntityData=hostelCacheData[id];$("#hostelInfo").hide();$("#hostelDetails").show().html('<div style="padding:150px 0;" align="center"><img src="/images/preloader.gif" alt="Loading..."/><br />Loading..</div>');$("#planHostelBtnBTR").show();$("#reviewFooterHostel").show();$("#hostelbuttonInfo").show();$("li").removeClass('current');$("#bing_attraction_info").hide('fade',500);var sText='';var url='/hostelworld/propertydetailsplan/pid/'+id;var detailText='';hostelList='<div id="hostelInfoList"><a class="scrollup" href="javascript://">&nbsp;</a>';hostelList+='<div class="pnlScrollCont">';hostelList+='<ul class="leftList vscroll-item">'+hostellist+'</li>';hostelList+='</div>';hostelList+='<a class="scrolldown" href="javascript://">&nbsp;</a></div>';$("#phostel .list").html(hostelList).show();if($("#hostelInfoList .vscroll-item").hasClass('scrolling')){}else{$("#hostelInfoList .vscroll-item").addClass('scrolling');scrollDiv('hostelInfoList');}
$("#hostelInfoList .vscroll-item section").removeClass('selected');$("#planHostelListChild"+arrayIndex).addClass('selected');if(typeof calledFrom=='undefined'){if($('#hostelInfoList .pnlScrollCont').height()<$("#planHostelListChild"+arrayIndex).position().top){if($("#hostelInfoList .vscroll-item").height()-$("#planHostelListChild"+arrayIndex).position().top<$('#hostelInfoList .pnlScrollCont').height()){$("#hostelInfoList .vscroll-item").css('top',$('#hostelInfoList .pnlScrollCont').height()-$('#hostelInfoList .vscroll-item').height());$('#hostelInfoList .scrollup').css('visibility','visible');$('#hostelInfoList .scrolldown').css('visibility','hidden');}else{$("#hostelInfoList .vscroll-item").css('top',-1*Number($("#planHostelListChild"+arrayIndex).position().top));$('#hostelInfoList .scrollup').css('visibility','visible');}}}
$.getJSON(url,function(data){var hostel=data.result;var description=hostel.description;if(typeof hostel.description=='undefined'||hostel.description==null){description='null';}
description=description.replace(//g,'');var hosteldesc=description.split("\n");var length=hosteldesc.length;var i=0;var desc='';while(i<length){desc+=hosteldesc[i]+'<br/>';i++;}
var ratingOfHostel=(parseInt(hostel.averageRating)==0)?'No':hostel.averageRating+'%';detailText+='<div id="hostelcontentPlan">';detailText+='<div><h2 class="mainHotelName">'+hostel.propertyName.replace("","")+'</h2><div>';detailText+='<div id="hostelWrapRatingTripPlan"><article class="fl"><span class="add_to_trip_button" id="detail_top_btn_'+id+'"></span></article>';detailText+='<article class="fr font_12 shadow_inside_left" style="margin-right:5%"><span class="hostel-rating-detail">'+ratingOfHostel+'</span>  &nbsp;<span class="font_13" style="color:#FF6600; font-weight: bolder;">Overall Rating</span></span></article></div>';if(explorePanelMode=='friend'){getRecommandButtonCode(16,id);}else{getAddToTripButtonCode(16,id);}
detailText+='<div style="clear:right">&nbsp;</div>';detailText+='<div class="hostelImg">';if(typeof hostel.propertyImages[0]!='undefined'){detailText+='<div id="planHostelDetailImage"><img  onError="this.src=\'/images/hostel_grid_default.gif\'" src="'+hostel.propertyImages[0].imageURL+'" class="lazyloading" /></div>';}else{detailText+='<div id="planHostelDetailImage"><img  src="/images/hostel_grid_default.gif" class="lazyloading" /></div>';}
detailText+='<div class="hotelImgThumb">';detailText+='<ul>';if(typeof hostel.propertyImages[0]!='undefined'){for(i=0;i<=4;i++){var countimg=hostel.propertyImages.length;if(i<=countimg-1){detailText+='<li><a href="javascript://" onclick="changeFilmstripImg(\'planHostelDetailImage\',\''+hostel.propertyImages[i].imageURL+'\');"><img src="'+hostel.propertyImages[i].imageURL.replace('.jpg','_s.jpg')+'" width="80" height="80" /></a></li>';}}}
detailText+='</ul>';detailText+='</div></div>';detailText+='<div class="fl">';detailText+='<div id="hostelMap"></div>';detailText+='<p class="hotelAddress">';var earliestTime;var latestTime;if(hostel.checkInTime.earliest>=10){earliestTime=hostel.checkInTime.earliest;}else{earliestTime='0'+hostel.checkInTime.earliest;}
if(hostel.checkInTime.latest>=10){latestTime=hostel.checkInTime.latest;}else{latestTime='0'+hostel.checkInTime.latest;}
detailText+='<span class="fr">Checkin Time<br /><strong>Earliest '+earliestTime+':00</strong><br /><strong>Latest '+latestTime+':00</strong></span>';detailText+=hostel.address1.replace(//g,'')+'<br />'+hostel.address2.replace(//g,'')+'<br />'+hostel.city+', '+hostel.country;detailText+='</p></div></div>';detailText+='<div class="fl width_100"><section class="show_my_trip shadow_top_inside">';detailText+='<article class="hotel_detail font_13 light_grey_text form_wrapper">';detailText+=' <div class="fl">Currency<br />';detailText+=' <div class="stylize-select marginR5">';detailText+='  <select name="planhostel_currency_check" style="width:110%" id="planhostel_currency_check" class="hotelDetailSelect">';detailText+='   <optgroup label="Popular currencies">';detailText+='    <option value="AUD">Australia, Dollars (AUD/$)</option><option value="CAD">Canada, Dollars (CAD/$)</option><option value="EUR">Euros (EUR/ )</option><option value="GBP">UK, Pounds (GBP/)</option><option value="USD" selected="selected">USA, Dollars (USD/$)</option></optgroup><optgroup label="All currencies"> <option value="ARS">Argentina, Pesos (ARS/$)</option><option value="AUD">Australia, Dollars (AUD/$)</option><option value="BRL">Brazil, Reals (BRL/R$)</option><option value="CAD">Canada, Dollars (CAD/$)</option><option value="CNY">China, Yuan Renminbi (CNY/)</option><option value="HRK">Croatia, Kuna (HRK/kn)</option><option value="CZK">Czech Republic, Koruny (CZK/K)</option><option value="DKK">Denmark, Kroner (DKK/kr)</option><option value="EUR">Euros (EUR/ )</option><option value="HUF">Hungary, Forint (HUF/Ft)</option><option value="INR">India, Rupees (INR/INR)</option><option value="JPY">Japan, Yen (JPY/)</option><option value="NZD">New Zealand, Dollars (NZD/$)</option><option value="NOK">Norway, Krone (NOK/kr)</option><option value="PLN">Poland, Zoty (PLN/z)</option><option value="RUB">Russia, Rubles (RUB/ )</option><option value="ZAR">South Africa, Rand (ZAR/R)</option><option value="KRW">South Korea Won (KRW/KRW)</option><option value="SEK">Sweden, Kronor (SEK/kr)</option><option value="CHF">Switzerland, Francs (CHF/CHF)</option><option value="TRY">Turkey, Lira (TRY/TL)</option><option value="GBP">UK, Pounds (GBP/)</option><option value="USD">USA, Dollars (USD/$)</option></optgroup>';detailText+='  </select>';detailText+='</div>';detailText+='</div>';detailText+=' <div class="fl">Check-in:<br /><input type="text" readonly="readonly" id="plan_hostel_availability_start" class="input_h31 b_radius_3 calendar mright5 hasdatepicker" value="15/09/2011"></div>';detailText+=' <div class="fl">Check-out:<br /><input type="text" readonly="readonly" id="plan_hostel_availability_end" class="input_h31 b_radius_3 calendar mright5 hasdatepicker" value="15/09/2011"></div>';detailText+=' <div class="fl"><input type="button" onclick="checkHostelAvailability('+id+',\'plan\');" class="book_now chk_avail mtop_5" value="Check Availability" /></div>';detailText+=' <div class="clearfloat"></div>';detailText+='</article>';detailText+='<div id="plan_availability_div" class="marginT20 marginB10"></div>';detailText+='<div class="shadow_bottom_inside clear marginB10">&nbsp;</div>';detailText+='</section>';detailText+='</div>';hostelDescription=hostel.description;if(length>0){detailText+='<div class="HotelDescripition marginT20" style="width:930px; float:none"><h3 class="clearfloat">About</h3><p>'+desc+'</p></div>';}
var arrAmentities=hostel.facilities;if(typeof arrAmentities[0]=='undefined'){detailText+='<div class="hotelAmenities fl marginT20"><h3 style="font-size:1.8em">Amenities</h3><ul>';detailText+='<li>No amenities available</li></ul></div>';}
else{detailText+='<div class="hotelAmenities fl marginT20 marginR20"><h3 class="clearfloat">Amenities</h3>';detailText+='<div><ul>';for(i=0;i<15;i++){if(typeof arrAmentities[i]!='undefined'){var ammenityText=trim(arrAmentities[i]);var ammenitylength=ammenityText.length;if(ammenitylength<=30){ammenityText=ammenityText;}else{ammenityText=ammenityText.substring(0,30)+"...";}
detailText+='<li title="'+arrAmentities[i]+'">'+ammenityText+'</li>';}}
detailText+='</ul></div>';detailText+='<div id="more_amenities_hostel" class="hide"><ul>';for(j=15;j<=arrAmentities.length;j++){if(typeof arrAmentities[j]!='undefined'){var ammenityText=trim(arrAmentities[j]);var ammenitylength=ammenityText.length;if(ammenitylength<=30){ammenityText=ammenityText;}else{ammenityText=ammenityText.substring(0,30)+"...";}
detailText+='<li title="'+arrAmentities[j]+'">'+ammenityText+'</li>';}}
detailText+='</ul></div>';if(arrAmentities.length>15){detailText+='<br class="clearfloat"/><center><div class="marginT10"><a class="blue_link font_13 strong curHandPointer" onclick="$(\'#more_amenities_hostel\').show();$(this).hide();">See more amenities...</a></div></center>';}
detailText+='</ul></div>';}
detailText+='<div class="ADescripition review-deatil marginT20" style="width:50%">';detailText+='<h3 style="font-size:1.8em"><a onclick="getReviewsFromUser('+id+',\''+id+'\',\'16\',\'plan\'); " id="myTripUserReviews_16">Reviews</a></h3><br/>';detailText+='<section class="comments_wrapper">';detailText+='<div id="plan_'+id+'_reviews_16" class="font_13"></div>';detailText+='<div class="user_review_panel margint20"><br /><br /><h4>Friends Reviews</h4>';detailText+='<article class="grey_box mtop_10 b_radius_5 hotel_smileys"> <a href="#"><span class="smiley smiley_like_med">&nbsp;</span> 50 <span class="font_12">like it</span></a> <a href="#"><span class="smiley smiley_ok_med">&nbsp;</span> 10 <span class="font_12">say It\'s ok</span></a> <a href="#"><span class="smiley smiley_d_lile_med">&nbsp;</span> 15 <span class="font_12">don\'t like it</span></a> </article>';detailText+='</div>';detailText+='</div>';detailText+='</section>';detailText+='<div class="clearfloat"></div>'
detailText+='</div>';sText=detailText;document.getElementById('hostelDetails').innerHTML=sText;getReviewsFromUser(id,id,16,'plan');$("#plan_hostel_availability_start").datepicker({inline:true,maxDate:'+1y -1d',altField:'#plan_hostel_availability_start',yearRange:'2012:2014',dateFormat:'mm-dd-yy',minDate:0,maxDate:'+1y',defaultDate:'+1m',onSelect:function(dateText,inst){getNextDate(dateText,'#plan_hostel_availability_end',false,'setforHostels');}});$("#plan_hostel_availability_end").datepicker({inline:true,maxDate:'+1y',altField:'#plan_hostel_availability_end',yearRange:'2012:2014',dateFormat:'mm-dd-yy',minDate:'+1d',defaultDate:'+1m +1d',onSelect:function(dateText,inst){var flag=ValidateReservationDates("#plan_hostel_availability_start","#plan_hostel_availability_end");if(!flag){setPreDefDate(dateText,'#plan_hostel_availability_start');}}});$("#plan_hostel_availability_start").datepicker('setDate','+1m');$("#plan_hostel_availability_start").datepicker('option','maxDate','+1y');$("#plan_hostel_availability_end").datepicker('setDate','+1m +1d');var maxdateforEnddate=$("#plan_hostel_availability_start").datepicker('getDate');if(maxdateforEnddate!==null){maxdateforEnddate.setDate(maxdateforEnddate.getDate()+30);}
$("#plan_hostel_availability_end").datepicker('option','maxDate',maxdateforEnddate);$("img.lazyloading").lazyload({placeholder:"/images/media-load.gif",effect:"fadeIn",threshold:400,imgonerror:'/images/hostel_grid_default.gif'});centerAndZoom(hostel.geo.latitude,hostel.geo.longitude,hostel.propertyNumber,'/images/hostel_01_active.png');objMap=new Microsoft.Maps.Map(document.getElementById('hostelMap'),{credentials:'AhJQ5JAtgnPi_omSWBrBll1mzwDZTtRktFgfeXNlUiR-i3bRuMc2inL0nAbGkRGE',width:416,height:240,enableClickableLogo:false,enableSearchLogo:false,showDashboard:false,showScalebar:false,zoom:16,mapTypeId:'auto',center:new Microsoft.Maps.Location(hostel.geo.latitude,hostel.geo.longitude)});var placePin=new Microsoft.Maps.Pushpin(objMap.getCenter(),null);objMap.entities.push(placePin);});$("#searchFilters").hide();}
function sortHostelByPrice(){sortByRatingFlag=true;sortBy='cheapestPrivate';if(hoselPriceFlag){var result=hostelCacheData.result.Properties.sort(sortJsonResultAsc);hoselPriceFlag=false;}else{var result=hostelCacheData.result.Properties.sort(sortJsonResultDesc);hoselPriceFlag=true;}
bookRenderHostels(hostelCacheData);}
function sortHostelByRating(){sortByRatingFlag=true;sortBy='avgRating';var result=hostelCacheData.result.Properties.sort(sortJsonResultAsc);renderHostels(result);}
function sortHostelByStar(){sortBy='avgRating';sortByRatingFlag=true;if(hoselStarFlag){var result=hostelCacheData.result.Properties.sort(sortJsonResultAsc);hoselStarFlag=false;}else{var result=hostelCacheData.result.Properties.sort(sortJsonResultDesc);hoselStarFlag=true;}
renderHostels(result);}
function sortHostelByStarForBooking(){sortBy='avgRating';sortByRatingFlag=true;if(hoselBookingStarFlag){var result=hostelCacheData.result.Properties.sort(sortJsonResultAsc);hoselBookingStarFlag=false;}else{var result=hostelCacheData.result.Properties.sort(sortJsonResultDesc);hoselBookingStarFlag=true;}
bookRenderHostels(hostelCacheData);}
function sortJsonResultAsc(a,b){if(sortBy=='avgRating'){return a.avgRating>b.avgRating?1:-1;}else{return false;}}
function sortJsonResultDesc(a,b){if(sortBy!=''){return a.avgRating<b.avgRating?1:-1;}else{return false;}}
var hostelNameFlag=true;function sortByHostelName(){sortBy='name';sortByRatingFlag=true;if(hostelNameFlag){var result=hostelCacheData.result.Properties.sort(sortHostelByNameAsc);hostelNameFlag=false;}else{var result=hostelCacheData.result.Properties.sort(sortHostelByNameDesc);hostelNameFlag=true;}
renderbHostels(result);}
function sortHostelByNameAsc(x,y){if(sortBy!=''){return((x.name==y.name)?0:((x.name>y.name)?1:-1));}else{return false;}}
function sortHostelByNameDesc(x,y){if(sortBy!=''){return((x.name==y.name)?0:((x.name<y.name)?1:-1));}else{return false;}}
function openHostels(sortType){activeExploreTab='Hostels';panelFlag=='friend';$("#phostel").show();$("#hostelbuttonInfo").hide();$("#hostelInfo").show();$("#hostelDetails").hide();$("#phostel .list").hide();$("#hostel .btnBTR").hide();$("#planHostelBtnBTR").hide();var sortOrder='0';if(sortType=='rating'){$("#plan-hostel_price_sort").attr('class','');Hostelplanprice_sort_order='0';if(Hostelplanrating_sort_order=='0'){sortOrder='REVIEW_AVG_RATING_D';$("#plan-hostel_star_sort").attr('class','');$("#plan-hostel_star_sort").addClass('active asc');Hostelplanrating_sort_order='1'}else{sortOrder='REVIEW_AVG_RATING_A';$("#plan-hostel_star_sort").attr('class','');$("#plan-hostel_star_sort").addClass('active desc');Hostelplanrating_sort_order='0';}
$("#clearHostelPlanFilterA").addClass('filter_enabled');$("#clearHostelPlanFilterA").removeClass('filter_disabled');}else if(typeof sortType=='undefined'){Hostelplanrating_sort_order='0';$("#plan-hostel_star_sort").attr('class','');$("#plan-hostel_price_sort").attr('class','');Hostelplanprice_sort_order='0';}
if(hostelFlag==false){hostelFlag=true;}
showBing();cityId=document.getElementById('hdnCityId').value;document.getElementById('hostelInfo').innerHTML='<div align="center" style="padding:20px 0 150px 0;">Loading..<br><img src="/images/panel-loader.gif"></div>';var url='/hostelworld/propertylistplan/cityId/'+cityId+'/sortType/'+sortOrder+'/sid/'+Math.random();var cacheKey="hst_"+cityId+"_0";if(cache[cacheKey]&&typeof sortType=='undefined'){hostelCacheData=cache[cacheKey];renderHostelsNew(hostelCacheData);ResetBrowserScrollAfterDataLoaded();}else{$.getJSON(url,function(fsdata){if(fsdata!=0){hostelCacheData=fsdata;if(typeof sortType=='undefined'){cache[cacheKey]=fsdata;}
$('#plan-hostelSorting').show();renderHostelsNew(fsdata);if(fsdata.length==1){$('#plan-hostelSorting').hide();}
ResetBrowserScrollAfterDataLoaded();if(isLiveServer==true){if(sortType=='rating'){pushGAEventTags('Plan','Hostel');}}}else{$("#plan-hostelSorting").hide();abortAjax();visibleMap='bing';showVectorMap();$("#hostelInfo").html('<article class="info padding align-center font_18">Sorry, we do not currently have any Hostel available for this city.</article>');$("#mapOverlay").hide();}});}}
var hostellist="";function renderHostelsNew(data){var sText='';var cCtr=1;var gCtr=1;hostellist='';$("#hostelInfo").show();$("#hostelDetails").hide();$("#phostel .list").hide();var sourceIds=$("#tripItemSourceIds").val();var userSourceIds=$("#userItemSourceIds").val();var sourceIdArray=sourceIds.split(',');var userSourceIdArray=userSourceIds.split(',');var addToTripText=explorePanelMode=='friend'?'Recommend':'Add to Trip';var removeFromTripText=explorePanelMode=='friend'?'Recommended':'Remove';var addToTripFlag=explorePanelMode=='friend'?'friend':'grid';if(sortByRatingFlag){var data=data;}else{hostelBingData=data;}
$.each(data,function(i,hostel){if(cCtr>HostelchkHCol){cCtr=1;gCtr++;}
var ratingOfhostel=(parseInt(hostel.averageRating)==0)?'':hostel.averageRating+"% <small>Overall Rating</small>&nbsp;&nbsp;&nbsp;";hostelName=hostel.propertyName;hostelName=removeDiacritics(hostelName);hostelName=hostelName.replace("","");var showTitle=false;if(typeof hostelName!='undefined'){if(hostelName.length>30){showTitle=true;hostelName=hostelName.replace("","");hostelName=hostelName.substring(0,30)+'...';}else{showTitle=false;hostelName=hostel.propertyName;hostelName=hostelName.replace("","");hostelName=removeDiacritics(hostelName);hostelName=hostelName.replace("","");}}
if(hostel.address1){hosteladd1=hostel.address1.replace(//g,'');}
hostel.hostelRating=hostel.starRating;hostellist+='<section id="planHostelListChild'+i+'" class="hotelList" onClick="openhostelDetailPlan('+hostel.propertyNumber+', '+i+')" >';hostellist+='<img class="lazyloading fl marginR10" onError="this.src=\'/images/hostel_grid_default.gif\'" src="'+hostel.propertyImage+'" width="70" height="44" />';if(showTitle){hostellist+='<p><a href="javascript:void(0);" title="'+hostel.propertyName+'"><strong>'+hostelName+'</strong></a><br>'}else{hostellist+='<p><a href="javascript:void(0);"><strong>'+hostelName+'</strong></a><br>'}
hostellist+=ratingOfhostel;hostellist+='</p></section>';var detailText='';detailText+='<article class="content">';detailText+='<a href="javascript:void(0);" onClick="openhostelDetailPlan('+hostel.propertyNumber+', '+i+')"><img class="lazyloading thumb" src="'+hostel.propertyImage+'" width="180" height="122" onError="this.src=\''+'/images/hostel_grid_default.gif'+'\'" /></a>';if(showTitle){detailText+='<p class="phostelGrid"><strong><span class="attrName"><a href="javascript://" onClick="openhostelDetailPlan('+hostel.propertyNumber+', '+i+');" title="'+hostel.propertyName+'">'+hostelName+'</a></span></strong>';}else{detailText+='<p class="phostelGrid"><strong><span class="attrName"><a href="javascript://" onClick="openhostelDetailPlan('+hostel.propertyNumber+', '+i+');">'+hostelName+'</a></span></strong>';}
detailText+='<span class="grey_borderbottom"><span class="hostel-rating">'+ratingOfhostel+hostel.propertyType+'</span></span>';detailText+='<span class="grey_borderbottom">'+hosteladd1+'<br/>'+hostel.address2.replace(//g,'')+'</span>';detailText+='</p>';detailText+='</article>';detailText+='<br class="clearfloat" /><article class="actionbuttons">';if(!(pastTrip&&explorePanelMode=='friend')){var itemsStatus=$("#tripItemStatus").val();var itemsStatusArray=itemsStatus.split(',');var allItems=$("#tripItemIds").val();var allItemsArray=allItems.split(',');var itemExist=contains(allItemsArray,hostel.propertyNumber);if(itemExist!=-1&&itemsStatusArray[itemExist]=='yes_16'&&explorePanelMode=='friend'){var gridId=hostel.propertyNumber;detailText+='<span class="highlight fl" id="gridBtn_'+gridId+'">Already added to trip</span>';}else if(sourceIdArray!=''||userSourceIdArray!=''){var isExists=inArrayJS(parseInt(hostel.propertyNumber)+'_16',sourceIdArray);if(isExists==true){var grid="grid";var gridId=hostel.propertyNumber;if(explorePanelMode=='friend')
{var foruserExist=inArrayJS(parseInt(hostel.propertyNumber)+'_16',userSourceIdArray);if(foruserExist==true){detailText+='<span class="highlight fl" id="gridBtn_'+gridId+'">Recommended by friends and You</span>';}
else{detailText+='<span class="highlight fl" id="gridBtn_'+gridId+'">Recommended by friends</span>';detailText+='<span id="gridBtn_frnd_'+gridId+'" class="fl"><a class="btnIconAdd blue_link" onClick="assignTripItemData(\'hostel\', '+i+'); addItemToTrip(\'16\', \'7\', \''+hostel.propertyNumber+'\', \''+addToTripFlag+'\',\'\',\''+i+'\')" href="javascript:void(0);">I Recommend</a></span>';}}else{detailText+='<span id="gridBtn_'+gridId+'" class="fl"><a href="javascript://" onClick="removeFromTrip(\'16\', \'7\', \''+hostel.propertyNumber+'\', \''+addToTripFlag+'\',\''+i+'\')" class="btnIconRemove font_13"> '+removeFromTripText+'</a></span>';}}else{if(explorePanelMode=='friend'){var foruserExist=inArrayJS(hostel.propertyNumber+'_16',userSourceIdArray);gridId=hostel.propertyNumber;if(foruserExist==true){detailText+='<span class="highlight fl" id="gridBtn_'+gridId+'">Recommended</span></p>';}
else{detailText+='<span id="gridBtn_'+gridId+'" class="fl"><a href="javascript://" onClick="assignTripItemData(\'hostel\', '+i+'); addItemToTrip(\'16\', \'7\', \''+hostel.propertyNumber+'\', \''+addToTripFlag+'\',\'\',\''+i+'\')" class="btnIconAdd blue_link"> '+addToTripText+' </a></span>';}}
else{var gridId=hostel.propertyNumber;detailText+='<span id="gridBtn_'+gridId+'" class="fl"><a href="javascript://" onClick="assignTripItemData(\'hostel\', '+i+'); addItemToTrip(\'16\', \'7\', \''+hostel.propertyNumber+'\', \''+addToTripFlag+'\',\'\',\''+i+'\')" class="btnIconAdd blue_link"> '+addToTripText+' </a></span>';}}}else{var gridId=hostel.propertyNumber;detailText+='<span id="gridBtn_'+gridId+'" class="fl"><a href="javascript://" onClick="assignTripItemData(\'hostel\', '+i+'); addItemToTrip(\'16\', \'7\', \''+hostel.propertyNumber+'\', \''+addToTripFlag+'\',\'\',\''+i+'\')" class="btnIconAdd blue_link"> '+addToTripText+' </a></span>';}}
detailText+='<span><button onclick="openhostelDetailPlan('+hostel.propertyNumber+', '+i+')" class="book_now fr">View More</button></span>';detailText+='<div class="clearfloat" />';detailText+='</article>';sText+='<section class="hostelG'+gCtr+'">'+detailText+'</section>';cCtr++;});document.getElementById('hostelInfo').innerHTML='<div class="top25">'+sText;+'</div>';for(i=1;i<=gCtr;i++){$('.hostelG'+i).equalizeHeights();if($('.hostelG'+i).height()==0)
{phostelCityId='';}}
phostelPlaces=hostelBingData;if(surfMode=='Plan'){if($('#chostel').hasClass('current')){plotHostelDataOnBingMapNew(hostelBingData);}}
$("img.lazyloading").lazyload({placeholder:"/images/media-load.gif",effect:"fadeIn",threshold:400});}
function filterHostelText(myString){if(typeof myString!='undefined'){myString=myString.replace(/\u25cf/g,'');myString=myString.replace(/\ufffd/g,'');myString=myString.replace(/\u2019/g,"'");myString=myString.replace(/\u00a3/g,"");myString=myString.replace(/\u201c/g,'"');myString=myString.replace(/\u201d/g,'"');myString=myString.replace(/\u2026/g,'');return myString;}}
var addedHostelRoom=new Array();addedHostelRoom['plan']=0;addedHostelRoom['book']=0;addedHostelRoom['MT']=0;function selectRoomForHostel(roomDescription,maxBeds,noOfDays,guests,tab,hostelId,price,roomCode){if(tab=='B'){tab='book';}else if(tab=='P'){tab='plan';}
if(guests==0){if(document.getElementById(tab+'_hostel_room_'+roomCode)!=null){$('#'+tab+'_hostel_room_'+roomCode).remove();addedHostelRoom[tab]--;}}else{var noOfRooms=Math.ceil(guests/maxBeds);var roomPrice=Math.round(price*noOfDays*100)/100;if(document.getElementById(tab+'_hostel_room_'+roomCode)!=null){$('#'+tab+'_hostel_roomDesc'+roomCode).text(roomDescription);$('#'+tab+'_hostel_roomNumber'+roomCode).text(noOfRooms);$('#'+tab+'_hostel_roomGuest'+roomCode).text(guests);$('#'+tab+'_hostel_roomPrice'+roomCode).text(roomPrice);}else{var newSegHtml='';newSegHtml+='<tr id="'+tab+'_hostel_room_'+roomCode+'">';newSegHtml+='<td style="text-align: left;"><span id="'+tab+'_hostel_roomDesc'+roomCode+'">'+roomDescription+'</span></td>';newSegHtml+='<td style="text-align: center;"><span id="'+tab+'_hostel_roomNumber'+roomCode+'">'+noOfRooms+'</span></td>';newSegHtml+='<td style="text-align: center;"><span id="'+tab+'_hostel_roomGuest'+roomCode+'">'+guests+'</span></td>';newSegHtml+='<td style="text-align: center;"><span id="'+tab+'_hostel_roomPrice'+roomCode+'">'+roomPrice+'</span></td>';newSegHtml+='</tr>';$(newSegHtml).insertBefore("#"+tab+"_hostel_book_button");addedHostelRoom[tab]++;}}
if(addedHostelRoom[tab]>0){$('#'+tab+'_hostel_room_selection').show();}else{$('#'+tab+'_hostel_room_selection').hide();}}